{"id":"36007397698","type":"IssueCommentEvent","actor":{"id":78042786,"login":"JiaT75","display_login":"JiaT75","gravatar_id":"","url":"https://api.github.com/users/JiaT75","avatar_url":"https://avatars.githubusercontent.com/u/78042786?"},"repo":{"id":553665726,"name":"tukaani-project/xz","url":"https://api.github.com/repos/tukaani-project/xz"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/88","repository_url":"https://api.github.com/repos/tukaani-project/xz","labels_url":"https://api.github.com/repos/tukaani-project/xz/issues/88/labels{/name}","comments_url":"https://api.github.com/repos/tukaani-project/xz/issues/88/comments","events_url":"https://api.github.com/repos/tukaani-project/xz/issues/88/events","html_url":"https://github.com/tukaani-project/xz/issues/88","id":2152797002,"node_id":"I_kwDOIQBEvs6AURNK","number":88,"title":"[Bug]: Compile problem: SYS_landlock_restrict_self is undeclared","user":{"login":"rubyFeedback","id":46686565,"node_id":"MDQ6VXNlcjQ2Njg2NTY1","avatar_url":"https://avatars.githubusercontent.com/u/46686565?v=4","gravatar_id":"","url":"https://api.github.com/users/rubyFeedback","html_url":"https://github.com/rubyFeedback","followers_url":"https://api.github.com/users/rubyFeedback/followers","following_url":"https://api.github.com/users/rubyFeedback/following{/other_user}","gists_url":"https://api.github.com/users/rubyFeedback/gists{/gist_id}","starred_url":"https://api.github.com/users/rubyFeedback/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rubyFeedback/subscriptions","organizations_url":"https://api.github.com/users/rubyFeedback/orgs","repos_url":"https://api.github.com/users/rubyFeedback/repos","events_url":"https://api.github.com/users/rubyFeedback/events{/privacy}","received_events_url":"https://api.github.com/users/rubyFeedback/received_events","type":"User","site_admin":false},"labels":[{"id":4687621022,"node_id":"LA_kwDOIQBEvs8AAAABF2drng","url":"https://api.github.com/repos/tukaani-project/xz/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2024-02-25T14:44:02Z","updated_at":"2024-02-26T11:49:04Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"### Describe the bug\r\n\r\n    make  all-recursive\r\n    make[1]: Entering directory '/Depot/jjj/xz-5.6.0'\r\n    Making all in src\r\n    make[2]: Entering directory '/Depot/jjj/xz-5.6.0/src'\r\n    Making all in liblzma\r\n    make[3]: Entering directory '/Depot/jjj/xz-5.6.0/src/liblzma'\r\n    Making all in api\r\n    make[4]: Entering directory '/Depot/jjj/xz-5.6.0/src/liblzma/api'\r\n    make[4]: Nothing to be done for 'all'.\r\n    make[4]: Leaving directory '/Depot/jjj/xz-5.6.0/src/liblzma/api'\r\n    make[4]: Entering directory '/Depot/jjj/xz-5.6.0/src/liblzma'\r\n    make[4]: Nothing to be done for 'all-am'.\r\n    make[4]: Leaving directory '/Depot/jjj/xz-5.6.0/src/liblzma'\r\n    make[3]: Leaving directory '/Depot/jjj/xz-5.6.0/src/liblzma'\r\n    Making all in xzdec\r\n    make[3]: Entering directory '/Depot/jjj/xz-5.6.0/src/xzdec'\r\n    gcc -DHAVE_CONFIG_H -I. -I../..  -DTUKLIB_GETTEXT=0 -I../../src/common -I../../src/liblzma/api -I../../lib  -pthread -fvisibility=hidden -Wall -Wextra -Wvla -Wformat=2 -Winit-self -Wmissing-include-dirs -Wshift-overflow=2 -Wstrict-overflow=3 -Walloc-zero -Wduplicated-cond -Wfloat-equal -Wundef -Wshadow -Wpointer-arith -Wbad-function-cast -Wwrite-strings -Wdate-time -Wsign-conversion -Wfloat-conversion -Wlogical-op -Waggregate-return -Wstrict-prototypes -Wold-style-definition -Wmissing-prototypes -Wmissing-declarations -Wredundant-decls -O2 -fPIC -fno-strict-overflow -Wno-error -MT xzdec-xzdec.o -MD -MP -MF .deps/xzdec-xzdec.Tpo -c -o xzdec-xzdec.o `test -f 'xzdec.c'     || echo './'`xzdec.c\r\n    xzdec.c: In function ‘sandbox_enter’:\r\n    xzdec.c:329:36: error: ‘SYS_landlock_create_ruleset’ undeclared (first use in this function)\r\n      329 |         int landlock_abi = syscall(SYS_landlock_create_ruleset,\r\n          |                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    xzdec.c:329:36: note: each undeclared identifier is reported only once for each function it appears in\r\n    xzdec.c:349:29: error: ‘SYS_landlock_restrict_self’ undeclared (first use in this function)\r\n      349 |                 if (syscall(SYS_landlock_restrict_self, ruleset_fd, 0U) != 0)\r\n          |                             ^~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    make[3]: *** [Makefile:606: xzdec-xzdec.o] Error 1\r\n    make[3]: Leaving directory '/Depot/jjj/xz-5.6.0/src/xzdec'\r\n    make[2]: *** [Makefile:427: all-recursive] Error 1\r\n    make[2]: Leaving directory '/Depot/jjj/xz-5.6.0/src'\r\n    make[1]: *** [Makefile:597: all-recursive] Error 1\r\n    make[1]: Leaving directory '/Depot/jjj/xz-5.6.0'\r\n    make: *** [Makefile:487: all] Error 2\r\n\r\n\r\nI can compile older xz releases fine by the way, on the same system, so 5.4.x, \r\n5.2.x. Not sure what changed.\r\n\r\nMy system is a custom built slackware; I recompiled most\r\nthings from source following mostly LFS/BLFS instructions.\r\nxz 5.6.x is not yet appearing on LFS, so I just poke in the\r\ndark here really.\r\n\r\nglibc is 2.33, gcc is 11.4.0.\r\n\r\n### Version\r\n\r\n5.6.0\r\n\r\n### Operating System\r\n\r\nlinux\r\n\r\n### Relevant log output\r\n\r\n_No response_","reactions":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/88/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tukaani-project/xz/issues/88/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/comments/1963960663","html_url":"https://github.com/tukaani-project/xz/issues/88#issuecomment-1963960663","issue_url":"https://api.github.com/repos/tukaani-project/xz/issues/88","id":1963960663,"node_id":"IC_kwDOIQBEvs51D6lX","user":{"login":"JiaT75","id":78042786,"node_id":"MDQ6VXNlcjc4MDQyNzg2","avatar_url":"https://avatars.githubusercontent.com/u/78042786?v=4","gravatar_id":"","url":"https://api.github.com/users/JiaT75","html_url":"https://github.com/JiaT75","followers_url":"https://api.github.com/users/JiaT75/followers","following_url":"https://api.github.com/users/JiaT75/following{/other_user}","gists_url":"https://api.github.com/users/JiaT75/gists{/gist_id}","starred_url":"https://api.github.com/users/JiaT75/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JiaT75/subscriptions","organizations_url":"https://api.github.com/users/JiaT75/orgs","repos_url":"https://api.github.com/users/JiaT75/repos","events_url":"https://api.github.com/users/JiaT75/events{/privacy}","received_events_url":"https://api.github.com/users/JiaT75/received_events","type":"User","site_admin":false},"created_at":"2024-02-26T11:49:03Z","updated_at":"2024-02-26T11:49:03Z","author_association":"MEMBER","body":"Hello! Thanks for the bug report and build logs. Luckily, the workaround for this is very simple. With Autotools build, you can pass the flag `--disable-sandbox` to `configure`. With CMake, pass `-DENABLE_SANDBOX=OFF`.\r\n\r\nThe underlying problem here is that we assumed having the `linux/landlock.h` header file meant that the system would also have `SYS_landlock_create_ruleset` and `SYS_landlock_restrict_self` defined in `sys/syscall.h`. So the fix on our side is to add checks for these system calls before setting `HAVE_LINUX_LANDLOCK_H` during configurations. ","reactions":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/comments/1963960663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-02-26T11:49:04Z","org":{"id":116083088,"login":"tukaani-project","gravatar_id":"","url":"https://api.github.com/orgs/tukaani-project","avatar_url":"https://avatars.githubusercontent.com/u/116083088?"}}
{"id":"36007677930","type":"PushEvent","actor":{"id":78042786,"login":"JiaT75","display_login":"JiaT75","gravatar_id":"","url":"https://api.github.com/users/JiaT75","avatar_url":"https://avatars.githubusercontent.com/u/78042786?"},"repo":{"id":553665726,"name":"tukaani-project/xz","url":"https://api.github.com/repos/tukaani-project/xz"},"payload":{"repository_id":553665726,"push_id":17269063156,"size":1,"distinct_size":1,"ref":"refs/heads/master","head":"9eed1b9a3ae140e93a82febc05a0181e9a4f5093","before":"8bf9f72ee1c05b9e205a72807e8a9e304785673d","commits":[{"sha":"9eed1b9a3ae140e93a82febc05a0181e9a4f5093","author":{"email":"jiat0218@gmail.com","name":"Jia Tan"},"message":"Tests: Correct license header in test_microlzma.c.","distinct":true,"url":"https://api.github.com/repos/tukaani-project/xz/commits/9eed1b9a3ae140e93a82febc05a0181e9a4f5093"}]},"public":true,"created_at":"2024-02-26T11:57:55Z","org":{"id":116083088,"login":"tukaani-project","gravatar_id":"","url":"https://api.github.com/orgs/tukaani-project","avatar_url":"https://avatars.githubusercontent.com/u/116083088?"}}
