{"id":"37288694922","type":"PullRequestReviewCommentEvent","actor":{"id":12179219,"login":"vibhatha","display_login":"vibhatha","gravatar_id":"","url":"https://api.github.com/users/vibhatha","avatar_url":"https://avatars.githubusercontent.com/u/12179219?"},"repo":{"id":51905353,"name":"apache/arrow","url":"https://api.github.com/repos/apache/arrow"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/apache/arrow/pulls/comments/1556977780","pull_request_review_id":1988184572,"id":1556977780,"node_id":"PRRC_kwDOAxgDSc5czZh0","diff_hunk":"@@ -61,9 +63,84 @@ def list_dependency_names(self):\n             names.append(name)\n         return names\n \n+    def _extract_symbols(self, symbol_info):\n+        return [re.search(r'\\S+$', line).group() for line in symbol_info if line]\n+\n+    def _remove_weak_symbols(self, symbol_info):\n+        return [line for line in symbol_info if not re.search(r'\\s[Ww]\\s', line)]\n+\n+    def _capture_symbols(self, remove_symbol_versions, symbol_info):\n+        if remove_symbol_versions:\n+            symbol_info = [re.split('@@', line)[0] for line in symbol_info]\n+        return symbol_info\n+\n+    def list_symbols_for_dependency(self, dependency, remove_symbol_versions=False):\n+        if dependency == 'linux-vdso.so.1':\n+            return []\n+        result = _nm.run('-D', dependency, stdout=subprocess.PIPE)","path":"dev/archery/archery/linking.py","commit_id":"e47c2181425e9e6c07da355f2b41c69195519d69","original_commit_id":"1eb63bc889dea521078c98b707c17eef77af5129","user":{"login":"vibhatha","id":12179219,"node_id":"MDQ6VXNlcjEyMTc5MjE5","avatar_url":"https://avatars.githubusercontent.com/u/12179219?v=4","gravatar_id":"","url":"https://api.github.com/users/vibhatha","html_url":"https://github.com/vibhatha","followers_url":"https://api.github.com/users/vibhatha/followers","following_url":"https://api.github.com/users/vibhatha/following{/other_user}","gists_url":"https://api.github.com/users/vibhatha/gists{/gist_id}","starred_url":"https://api.github.com/users/vibhatha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vibhatha/subscriptions","organizations_url":"https://api.github.com/users/vibhatha/orgs","repos_url":"https://api.github.com/users/vibhatha/repos","events_url":"https://api.github.com/users/vibhatha/events{/privacy}","received_events_url":"https://api.github.com/users/vibhatha/received_events","type":"User","site_admin":false},"body":"while building the image, I got the following error\r\n\r\n```bash\r\n237.2 error: Failed to download from mirror set\r\n237.2 error: https://github.com/tukaani-project/xz/archive/v5.4.4.tar.gz: curl failed to download with exit code 22\r\n```\r\nhttps://github.com/tukaani-project/xz/archive/v5.4.4.tar.gz -> Not found\r\n","created_at":"2024-04-09T06:15:50Z","updated_at":"2024-04-09T06:15:50Z","html_url":"https://github.com/apache/arrow/pull/40520#discussion_r1556977780","pull_request_url":"https://api.github.com/repos/apache/arrow/pulls/40520","author_association":"COLLABORATOR","_links":{"self":{"href":"https://api.github.com/repos/apache/arrow/pulls/comments/1556977780"},"html":{"href":"https://github.com/apache/arrow/pull/40520#discussion_r1556977780"},"pull_request":{"href":"https://api.github.com/repos/apache/arrow/pulls/40520"}},"reactions":{"url":"https://api.github.com/repos/apache/arrow/pulls/comments/1556977780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":81,"original_line":80,"side":"RIGHT","in_reply_to_id":1555915805,"original_position":34,"position":35,"subject_type":"line"},"pull_request":{"url":"https://api.github.com/repos/apache/arrow/pulls/40520","id":1771125106,"node_id":"PR_kwDOAxgDSc5pkTly","html_url":"https://github.com/apache/arrow/pull/40520","diff_url":"https://github.com/apache/arrow/pull/40520.diff","patch_url":"https://github.com/apache/arrow/pull/40520.patch","issue_url":"https://api.github.com/repos/apache/arrow/issues/40520","number":40520,"state":"open","locked":false,"title":"GH-40964: [CI][Archery] Archery linking should also check for undefined symbols Linux","user":{"login":"vibhatha","id":12179219,"node_id":"MDQ6VXNlcjEyMTc5MjE5","avatar_url":"https://avatars.githubusercontent.com/u/12179219?v=4","gravatar_id":"","url":"https://api.github.com/users/vibhatha","html_url":"https://github.com/vibhatha","followers_url":"https://api.github.com/users/vibhatha/followers","following_url":"https://api.github.com/users/vibhatha/following{/other_user}","gists_url":"https://api.github.com/users/vibhatha/gists{/gist_id}","starred_url":"https://api.github.com/users/vibhatha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vibhatha/subscriptions","organizations_url":"https://api.github.com/users/vibhatha/orgs","repos_url":"https://api.github.com/users/vibhatha/repos","events_url":"https://api.github.com/users/vibhatha/events{/privacy}","received_events_url":"https://api.github.com/users/vibhatha/received_events","type":"User","site_admin":false},"body":"### Rationale for this change\r\n\r\nThis PR includes a check to find out if there are undefined symbols associated with the libraries. \r\n\r\n### What changes are included in this PR?\r\n\r\nIncludes a util functions which uses `nm` and `ldconfig` tools to find out libraries and their symbols and determine\r\nif there are undefined symbols excluding the symbols in the allowed dependencies. \r\n\r\n### Are these changes tested?\r\n\r\nLocally tested with a faulty shared library, but this needs validation on versions as there is a version mismatch in the local libraries. \r\n\r\n### Are there any user-facing changes?\r\n\r\nNo\r\n* GitHub Issue: #40964","created_at":"2024-03-14T00:21:35Z","updated_at":"2024-04-09T06:15:50Z","closed_at":null,"merged_at":null,"merge_commit_sha":"51bef7532725ea0be5a6a29997a61f7f0288c04e","assignee":null,"assignees":[],"requested_reviewers":[{"login":"kou","id":27350,"node_id":"MDQ6VXNlcjI3MzUw","avatar_url":"https://avatars.githubusercontent.com/u/27350?v=4","gravatar_id":"","url":"https://api.github.com/users/kou","html_url":"https://github.com/kou","followers_url":"https://api.github.com/users/kou/followers","following_url":"https://api.github.com/users/kou/following{/other_user}","gists_url":"https://api.github.com/users/kou/gists{/gist_id}","starred_url":"https://api.github.com/users/kou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kou/subscriptions","organizations_url":"https://api.github.com/users/kou/orgs","repos_url":"https://api.github.com/users/kou/repos","events_url":"https://api.github.com/users/kou/events{/privacy}","received_events_url":"https://api.github.com/users/kou/received_events","type":"User","site_admin":false},{"login":"raulcd","id":639755,"node_id":"MDQ6VXNlcjYzOTc1NQ==","avatar_url":"https://avatars.githubusercontent.com/u/639755?v=4","gravatar_id":"","url":"https://api.github.com/users/raulcd","html_url":"https://github.com/raulcd","followers_url":"https://api.github.com/users/raulcd/followers","following_url":"https://api.github.com/users/raulcd/following{/other_user}","gists_url":"https://api.github.com/users/raulcd/gists{/gist_id}","starred_url":"https://api.github.com/users/raulcd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raulcd/subscriptions","organizations_url":"https://api.github.com/users/raulcd/orgs","repos_url":"https://api.github.com/users/raulcd/repos","events_url":"https://api.github.com/users/raulcd/events{/privacy}","received_events_url":"https://api.github.com/users/raulcd/received_events","type":"User","site_admin":false},{"login":"pitrou","id":1721820,"node_id":"MDQ6VXNlcjE3MjE4MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1721820?v=4","gravatar_id":"","url":"https://api.github.com/users/pitrou","html_url":"https://github.com/pitrou","followers_url":"https://api.github.com/users/pitrou/followers","following_url":"https://api.github.com/users/pitrou/following{/other_user}","gists_url":"https://api.github.com/users/pitrou/gists{/gist_id}","starred_url":"https://api.github.com/users/pitrou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pitrou/subscriptions","organizations_url":"https://api.github.com/users/pitrou/orgs","repos_url":"https://api.github.com/users/pitrou/repos","events_url":"https://api.github.com/users/pitrou/events{/privacy}","received_events_url":"https://api.github.com/users/pitrou/received_events","type":"User","site_admin":false},{"login":"assignUser","id":16141871,"node_id":"MDQ6VXNlcjE2MTQxODcx","avatar_url":"https://avatars.githubusercontent.com/u/16141871?v=4","gravatar_id":"","url":"https://api.github.com/users/assignUser","html_url":"https://github.com/assignUser","followers_url":"https://api.github.com/users/assignUser/followers","following_url":"https://api.github.com/users/assignUser/following{/other_user}","gists_url":"https://api.github.com/users/assignUser/gists{/gist_id}","starred_url":"https://api.github.com/users/assignUser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/assignUser/subscriptions","organizations_url":"https://api.github.com/users/assignUser/orgs","repos_url":"https://api.github.com/users/assignUser/repos","events_url":"https://api.github.com/users/assignUser/events{/privacy}","received_events_url":"https://api.github.com/users/assignUser/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[{"id":5149835625,"node_id":"LA_kwDOAxgDSc8AAAABMvRBaQ","url":"https://api.github.com/repos/apache/arrow/labels/awaiting%20changes","name":"awaiting changes","color":"006b75","default":false,"description":"Awaiting changes"}],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/apache/arrow/pulls/40520/commits","review_comments_url":"https://api.github.com/repos/apache/arrow/pulls/40520/comments","review_comment_url":"https://api.github.com/repos/apache/arrow/pulls/comments{/number}","comments_url":"https://api.github.com/repos/apache/arrow/issues/40520/comments","statuses_url":"https://api.github.com/repos/apache/arrow/statuses/e47c2181425e9e6c07da355f2b41c69195519d69","head":{"label":"vibhatha:fix-ci-linking-warnings","ref":"fix-ci-linking-warnings","sha":"e47c2181425e9e6c07da355f2b41c69195519d69","user":{"login":"vibhatha","id":12179219,"node_id":"MDQ6VXNlcjEyMTc5MjE5","avatar_url":"https://avatars.githubusercontent.com/u/12179219?v=4","gravatar_id":"","url":"https://api.github.com/users/vibhatha","html_url":"https://github.com/vibhatha","followers_url":"https://api.github.com/users/vibhatha/followers","following_url":"https://api.github.com/users/vibhatha/following{/other_user}","gists_url":"https://api.github.com/users/vibhatha/gists{/gist_id}","starred_url":"https://api.github.com/users/vibhatha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vibhatha/subscriptions","organizations_url":"https://api.github.com/users/vibhatha/orgs","repos_url":"https://api.github.com/users/vibhatha/repos","events_url":"https://api.github.com/users/vibhatha/events{/privacy}","received_events_url":"https://api.github.com/users/vibhatha/received_events","type":"User","site_admin":false},"repo":{"id":433685131,"node_id":"R_kgDOGdmCiw","name":"arrow","full_name":"vibhatha/arrow","private":false,"owner":{"login":"vibhatha","id":12179219,"node_id":"MDQ6VXNlcjEyMTc5MjE5","avatar_url":"https://avatars.githubusercontent.com/u/12179219?v=4","gravatar_id":"","url":"https://api.github.com/users/vibhatha","html_url":"https://github.com/vibhatha","followers_url":"https://api.github.com/users/vibhatha/followers","following_url":"https://api.github.com/users/vibhatha/following{/other_user}","gists_url":"https://api.github.com/users/vibhatha/gists{/gist_id}","starred_url":"https://api.github.com/users/vibhatha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vibhatha/subscriptions","organizations_url":"https://api.github.com/users/vibhatha/orgs","repos_url":"https://api.github.com/users/vibhatha/repos","events_url":"https://api.github.com/users/vibhatha/events{/privacy}","received_events_url":"https://api.github.com/users/vibhatha/received_events","type":"User","site_admin":false},"html_url":"https://github.com/vibhatha/arrow","description":"Apache Arrow is a multi-language toolbox for accelerated data interchange and in-memory processing","fork":true,"url":"https://api.github.com/repos/vibhatha/arrow","forks_url":"https://api.github.com/repos/vibhatha/arrow/forks","keys_url":"https://api.github.com/repos/vibhatha/arrow/keys{/key_id}","collaborators_url":"https://api.github.com/repos/vibhatha/arrow/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/vibhatha/arrow/teams","hooks_url":"https://api.github.com/repos/vibhatha/arrow/hooks","issue_events_url":"https://api.github.com/repos/vibhatha/arrow/issues/events{/number}","events_url":"https://api.github.com/repos/vibhatha/arrow/events","assignees_url":"https://api.github.com/repos/vibhatha/arrow/assignees{/user}","branches_url":"https://api.github.com/repos/vibhatha/arrow/branches{/branch}","tags_url":"https://api.github.com/repos/vibhatha/arrow/tags","blobs_url":"https://api.github.com/repos/vibhatha/arrow/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/vibhatha/arrow/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/vibhatha/arrow/git/refs{/sha}","trees_url":"https://api.github.com/repos/vibhatha/arrow/git/trees{/sha}","statuses_url":"https://api.github.com/repos/vibhatha/arrow/statuses/{sha}","languages_url":"https://api.github.com/repos/vibhatha/arrow/languages","stargazers_url":"https://api.github.com/repos/vibhatha/arrow/stargazers","contributors_url":"https://api.github.com/repos/vibhatha/arrow/contributors","subscribers_url":"https://api.github.com/repos/vibhatha/arrow/subscribers","subscription_url":"https://api.github.com/repos/vibhatha/arrow/subscription","commits_url":"https://api.github.com/repos/vibhatha/arrow/commits{/sha}","git_commits_url":"https://api.github.com/repos/vibhatha/arrow/git/commits{/sha}","comments_url":"https://api.github.com/repos/vibhatha/arrow/comments{/number}","issue_comment_url":"https://api.github.com/repos/vibhatha/arrow/issues/comments{/number}","contents_url":"https://api.github.com/repos/vibhatha/arrow/contents/{+path}","compare_url":"https://api.github.com/repos/vibhatha/arrow/compare/{base}...{head}","merges_url":"https://api.github.com/repos/vibhatha/arrow/merges","archive_url":"https://api.github.com/repos/vibhatha/arrow/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/vibhatha/arrow/downloads","issues_url":"https://api.github.com/repos/vibhatha/arrow/issues{/number}","pulls_url":"https://api.github.com/repos/vibhatha/arrow/pulls{/number}","milestones_url":"https://api.github.com/repos/vibhatha/arrow/milestones{/number}","notifications_url":"https://api.github.com/repos/vibhatha/arrow/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/vibhatha/arrow/labels{/name}","releases_url":"https://api.github.com/repos/vibhatha/arrow/releases{/id}","deployments_url":"https://api.github.com/repos/vibhatha/arrow/deployments","created_at":"2021-12-01T04:42:33Z","updated_at":"2023-03-05T05:26:10Z","pushed_at":"2024-04-08T23:56:40Z","git_url":"git://github.com/vibhatha/arrow.git","ssh_url":"git@github.com:vibhatha/arrow.git","clone_url":"https://github.com/vibhatha/arrow.git","svn_url":"https://github.com/vibhatha/arrow","homepage":"https://arrow.apache.org/","size":182308,"stargazers_count":1,"watchers_count":1,"language":"C++","has_issues":false,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":0,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":0,"open_issues":0,"watchers":1,"default_branch":"master"}},"base":{"label":"apache:main","ref":"main","sha":"b6c4fbc2ce9281829b625d33a736262f3f9ae739","user":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"repo":{"id":51905353,"node_id":"MDEwOlJlcG9zaXRvcnk1MTkwNTM1Mw==","name":"arrow","full_name":"apache/arrow","private":false,"owner":{"login":"apache","id":47359,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3MzU5","avatar_url":"https://avatars.githubusercontent.com/u/47359?v=4","gravatar_id":"","url":"https://api.github.com/users/apache","html_url":"https://github.com/apache","followers_url":"https://api.github.com/users/apache/followers","following_url":"https://api.github.com/users/apache/following{/other_user}","gists_url":"https://api.github.com/users/apache/gists{/gist_id}","starred_url":"https://api.github.com/users/apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apache/subscriptions","organizations_url":"https://api.github.com/users/apache/orgs","repos_url":"https://api.github.com/users/apache/repos","events_url":"https://api.github.com/users/apache/events{/privacy}","received_events_url":"https://api.github.com/users/apache/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/apache/arrow","description":"Apache Arrow is a multi-language toolbox for accelerated data interchange and in-memory processing","fork":false,"url":"https://api.github.com/repos/apache/arrow","forks_url":"https://api.github.com/repos/apache/arrow/forks","keys_url":"https://api.github.com/repos/apache/arrow/keys{/key_id}","collaborators_url":"https://api.github.com/repos/apache/arrow/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/apache/arrow/teams","hooks_url":"https://api.github.com/repos/apache/arrow/hooks","issue_events_url":"https://api.github.com/repos/apache/arrow/issues/events{/number}","events_url":"https://api.github.com/repos/apache/arrow/events","assignees_url":"https://api.github.com/repos/apache/arrow/assignees{/user}","branches_url":"https://api.github.com/repos/apache/arrow/branches{/branch}","tags_url":"https://api.github.com/repos/apache/arrow/tags","blobs_url":"https://api.github.com/repos/apache/arrow/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/apache/arrow/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/apache/arrow/git/refs{/sha}","trees_url":"https://api.github.com/repos/apache/arrow/git/trees{/sha}","statuses_url":"https://api.github.com/repos/apache/arrow/statuses/{sha}","languages_url":"https://api.github.com/repos/apache/arrow/languages","stargazers_url":"https://api.github.com/repos/apache/arrow/stargazers","contributors_url":"https://api.github.com/repos/apache/arrow/contributors","subscribers_url":"https://api.github.com/repos/apache/arrow/subscribers","subscription_url":"https://api.github.com/repos/apache/arrow/subscription","commits_url":"https://api.github.com/repos/apache/arrow/commits{/sha}","git_commits_url":"https://api.github.com/repos/apache/arrow/git/commits{/sha}","comments_url":"https://api.github.com/repos/apache/arrow/comments{/number}","issue_comment_url":"https://api.github.com/repos/apache/arrow/issues/comments{/number}","contents_url":"https://api.github.com/repos/apache/arrow/contents/{+path}","compare_url":"https://api.github.com/repos/apache/arrow/compare/{base}...{head}","merges_url":"https://api.github.com/repos/apache/arrow/merges","archive_url":"https://api.github.com/repos/apache/arrow/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/apache/arrow/downloads","issues_url":"https://api.github.com/repos/apache/arrow/issues{/number}","pulls_url":"https://api.github.com/repos/apache/arrow/pulls{/number}","milestones_url":"https://api.github.com/repos/apache/arrow/milestones{/number}","notifications_url":"https://api.github.com/repos/apache/arrow/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/apache/arrow/labels{/name}","releases_url":"https://api.github.com/repos/apache/arrow/releases{/id}","deployments_url":"https://api.github.com/repos/apache/arrow/deployments","created_at":"2016-02-17T08:00:23Z","updated_at":"2024-04-08T16:50:38Z","pushed_at":"2024-04-09T03:07:51Z","git_url":"git://github.com/apache/arrow.git","ssh_url":"git@github.com:apache/arrow.git","clone_url":"https://github.com/apache/arrow.git","svn_url":"https://github.com/apache/arrow","homepage":"https://arrow.apache.org/","size":185323,"stargazers_count":13412,"watchers_count":13412,"language":"C++","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":3289,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":4447,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["arrow"],"visibility":"public","forks":3289,"open_issues":4447,"watchers":13412,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/apache/arrow/pulls/40520"},"html":{"href":"https://github.com/apache/arrow/pull/40520"},"issue":{"href":"https://api.github.com/repos/apache/arrow/issues/40520"},"comments":{"href":"https://api.github.com/repos/apache/arrow/issues/40520/comments"},"review_comments":{"href":"https://api.github.com/repos/apache/arrow/pulls/40520/comments"},"review_comment":{"href":"https://api.github.com/repos/apache/arrow/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/apache/arrow/pulls/40520/commits"},"statuses":{"href":"https://api.github.com/repos/apache/arrow/statuses/e47c2181425e9e6c07da355f2b41c69195519d69"}},"author_association":"COLLABORATOR","auto_merge":null,"active_lock_reason":null}},"public":true,"created_at":"2024-04-09T06:15:50Z","org":{"id":47359,"login":"apache","gravatar_id":"","url":"https://api.github.com/orgs/apache","avatar_url":"https://avatars.githubusercontent.com/u/47359?"}}
{"id":"37289487353","type":"IssueCommentEvent","actor":{"id":59720715,"login":"rjindael","display_login":"rjindael","gravatar_id":"","url":"https://api.github.com/users/rjindael","avatar_url":"https://avatars.githubusercontent.com/u/59720715?"},"repo":{"id":68312233,"name":"microsoft/vcpkg","url":"https://api.github.com/repos/microsoft/vcpkg"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/microsoft/vcpkg/issues/37893","repository_url":"https://api.github.com/repos/microsoft/vcpkg","labels_url":"https://api.github.com/repos/microsoft/vcpkg/issues/37893/labels{/name}","comments_url":"https://api.github.com/repos/microsoft/vcpkg/issues/37893/comments","events_url":"https://api.github.com/repos/microsoft/vcpkg/issues/37893/events","html_url":"https://github.com/microsoft/vcpkg/issues/37893","id":2217797449,"node_id":"I_kwDOBBJcqc6EMOdJ","number":37893,"title":"[liblzma] Unable to download \"xz\" caused install falied","user":{"login":"zhang49","id":41795441,"node_id":"MDQ6VXNlcjQxNzk1NDQx","avatar_url":"https://avatars.githubusercontent.com/u/41795441?v=4","gravatar_id":"","url":"https://api.github.com/users/zhang49","html_url":"https://github.com/zhang49","followers_url":"https://api.github.com/users/zhang49/followers","following_url":"https://api.github.com/users/zhang49/following{/other_user}","gists_url":"https://api.github.com/users/zhang49/gists{/gist_id}","starred_url":"https://api.github.com/users/zhang49/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhang49/subscriptions","organizations_url":"https://api.github.com/users/zhang49/orgs","repos_url":"https://api.github.com/users/zhang49/repos","events_url":"https://api.github.com/users/zhang49/events{/privacy}","received_events_url":"https://api.github.com/users/zhang49/received_events","type":"User","site_admin":false},"labels":[{"id":1524417665,"node_id":"MDU6TGFiZWwxNTI0NDE3NjY1","url":"https://api.github.com/repos/microsoft/vcpkg/labels/depends:upstream-changes","name":"depends:upstream-changes","color":"8a9dff","default":false,"description":"Waiting on a change to the upstream project"}],"state":"open","locked":false,"assignee":{"login":"jimwang118","id":122244446,"node_id":"U_kgDOB0lNXg","avatar_url":"https://avatars.githubusercontent.com/u/122244446?v=4","gravatar_id":"","url":"https://api.github.com/users/jimwang118","html_url":"https://github.com/jimwang118","followers_url":"https://api.github.com/users/jimwang118/followers","following_url":"https://api.github.com/users/jimwang118/following{/other_user}","gists_url":"https://api.github.com/users/jimwang118/gists{/gist_id}","starred_url":"https://api.github.com/users/jimwang118/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimwang118/subscriptions","organizations_url":"https://api.github.com/users/jimwang118/orgs","repos_url":"https://api.github.com/users/jimwang118/repos","events_url":"https://api.github.com/users/jimwang118/events{/privacy}","received_events_url":"https://api.github.com/users/jimwang118/received_events","type":"User","site_admin":false},"assignees":[{"login":"jimwang118","id":122244446,"node_id":"U_kgDOB0lNXg","avatar_url":"https://avatars.githubusercontent.com/u/122244446?v=4","gravatar_id":"","url":"https://api.github.com/users/jimwang118","html_url":"https://github.com/jimwang118","followers_url":"https://api.github.com/users/jimwang118/followers","following_url":"https://api.github.com/users/jimwang118/following{/other_user}","gists_url":"https://api.github.com/users/jimwang118/gists{/gist_id}","starred_url":"https://api.github.com/users/jimwang118/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimwang118/subscriptions","organizations_url":"https://api.github.com/users/jimwang118/orgs","repos_url":"https://api.github.com/users/jimwang118/repos","events_url":"https://api.github.com/users/jimwang118/events{/privacy}","received_events_url":"https://api.github.com/users/jimwang118/received_events","type":"User","site_admin":false}],"milestone":null,"comments":15,"created_at":"2024-04-01T08:23:06Z","updated_at":"2024-04-09T06:50:00Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"D:\\vcpkg>vcpkg.exe install opencv2\r\nwarning: In the September 2023 release, the default triplet for vcpkg libraries changed from x86-windows to the detected host triplet (x64-windows). For the old behavior, add --triplet x86-windows . To suppress this message, add --triplet x64-windows .\r\nComputing installation plan...\r\nThe following packages will be built and installed:\r\n  * liblzma:x64-windows -> 5.4.4\r\n  * libpng:x64-windows -> 1.6.39#1\r\n    opencv2[core,default-features,eigen,jpeg,png,tiff]:x64-windows -> 2.4.13.7#19\r\n  * tiff[core,jpeg,lzma,zip]:x64-windows -> 4.6.0#1\r\n  * vcpkg-get-python-packages:x64-windows -> 2023-07-28\r\n  * zlib:x64-windows -> 1.3\r\nAdditional packages (*) will be modified to complete this operation.\r\nDetecting compiler hash for triplet x64-windows...\r\nRestored 0 package(s) from C:\\Users\\heyy\\AppData\\Local\\vcpkg\\archives in 141 us. Use --debug to see more details.\r\nInstalling 1/6 liblzma:x64-windows...\r\nBuilding liblzma:x64-windows...\r\n-- Downloading https://github.com/tukaani-project/xz/archive/v5.4.4.tar.gz -> tukaani-project-xz-v5.4.4.tar.gz...\r\n[DEBUG] To include the environment variables in debug output, pass --debug-env\r\n[DEBUG] Trying to load bundleconfig from D:\\vcpkg\\vcpkg-bundle.json\r\n[DEBUG] Failed to open: D:\\vcpkg\\vcpkg-bundle.json\r\n[DEBUG] Bundle config: readonly=false, usegitregistry=false, embeddedsha=nullopt, deployment=Git, vsversion=nullopt\r\n[DEBUG] Metrics enabled.\r\n[DEBUG] Feature flag 'binarycaching' unset\r\n[DEBUG] Feature flag 'compilertracking' unset\r\n[DEBUG] Feature flag 'registries' unset\r\n[DEBUG] Feature flag 'versions' unset\r\n[DEBUG] Feature flag 'dependencygraph' unset\r\nDownloading https://github.com/tukaani-project/xz/archive/v5.4.4.tar.gz\r\n[DEBUG] Trying to hash D:\\vcpkg\\downloads\\tukaani-project-xz-v5.4.4.tar.gz.16680.part\r\n[DEBUG] D:\\vcpkg\\downloads\\tukaani-project-xz-v5.4.4.tar.gz.16680.part has hash 77255aac06aad2d93e1778cd9ca3a7df2da6c60b362d12e764055e83eb84b8f29c45b150a9818aa251c82af62233841db10ae6e4a076d6a6a007a60a5a6227a6\r\nerror: Failed to download from mirror set\r\nerror: File does not have the expected hash:\r\nurl: https://github.com/tukaani-project/xz/archive/v5.4.4.tar.gz\r\nFile: D:\\vcpkg\\downloads\\tukaani-project-xz-v5.4.4.tar.gz.16680.part\r\nExpected hash: c28461123562564e030f3f733f078bc4c840e87598d9f4b718d4bca639120d8133f969c45d7bdc62f33f081d789ec0f14a1791fb7da18515682bfe3c0c7362e0\r\nActual hash: 77255aac06aad2d93e1778cd9ca3a7df2da6c60b362d12e764055e83eb84b8f29c45b150a9818aa251c82af62233841db10ae6e4a076d6a6a007a60a5a6227a6\r\n[DEBUG] D:\\a\\_work\\1\\s\\src\\vcpkg\\base\\downloads.cpp(1051):\r\n[DEBUG] Time in subprocesses: 0us\r\n[DEBUG] Time in parsing JSON: 5us\r\n[DEBUG] Time in JSON reader: 0us\r\n[DEBUG] Time in filesystem: 729us\r\n[DEBUG] Time in loading ports: 0us\r\n[DEBUG] Exiting after 3.1 s (3092955us)\r\n\r\nCMake Error at scripts/cmake/vcpkg_download_distfile.cmake:32 (message):\r\n\r\n      Failed to download file with error: 1\r\n      If you are using a proxy, please check your proxy setting. Possible causes are:\r\n\r\n      1. You are actually using an HTTP proxy, but setting HTTPS_PROXY variable\r\n         to `https://address:port`. This is not correct, because `https://` prefix\r\n         claims the proxy is an HTTPS proxy, while your proxy (v2ray, shadowsocksr\r\n         , etc..) is an HTTP proxy. Try setting `http://address:port` to both\r\n         HTTP_PROXY and HTTPS_PROXY instead.\r\n\r\n      2. If you are using Windows, vcpkg will automatically use your Windows IE Proxy Settings\r\n         set by your proxy software. See https://github.com/microsoft/vcpkg-tool/pull/77\r\n         The value set by your proxy might be wrong, or have same `https://` prefix issue.\r\n\r\n      3. Your proxy's remote server is out of service.\r\n\r\n      If you've tried directly download the link, and believe this is not a temporary\r\n      download server failure, please submit an issue at https://github.com/Microsoft/vcpkg/issues\r\n      to report this upstream download server failure.\r\n\r\n\r\nCall Stack (most recent call first):\r\n  scripts/cmake/vcpkg_download_distfile.cmake:270 (z_vcpkg_download_distfile_show_proxy_and_fail)\r\n  scripts/cmake/vcpkg_from_github.cmake:106 (vcpkg_download_distfile)\r\n  ports/liblzma/portfile.cmake:1 (vcpkg_from_github)\r\n  scripts/ports.cmake:168 (include)\r\n\r\n\r\nerror: building liblzma:x64-windows failed with: BUILD_FAILED\r\nElapsed time to handle liblzma:x64-windows: 3.2 s\r\nPlease ensure you're using the latest port files with `git pull` and `vcpkg update`.\r\nThen check for known issues at:\r\n  https://github.com/microsoft/vcpkg/issues?q=is%3Aissue+is%3Aopen+in%3Atitle+liblzma\r\nYou can submit a new issue at:\r\n  https://github.com/microsoft/vcpkg/issues/new?title=[liblzma]+Build+error&body=Copy+issue+body+from+D%3A%2Fvcpkg%2Finstalled%2Fvcpkg%2Fissue_body.md","reactions":{"url":"https://api.github.com/repos/microsoft/vcpkg/issues/37893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/microsoft/vcpkg/issues/37893/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/microsoft/vcpkg/issues/comments/2044264686","html_url":"https://github.com/microsoft/vcpkg/issues/37893#issuecomment-2044264686","issue_url":"https://api.github.com/repos/microsoft/vcpkg/issues/37893","id":2044264686,"node_id":"IC_kwDOBBJcqc552QDu","user":{"login":"rjindael","id":59720715,"node_id":"MDQ6VXNlcjU5NzIwNzE1","avatar_url":"https://avatars.githubusercontent.com/u/59720715?v=4","gravatar_id":"","url":"https://api.github.com/users/rjindael","html_url":"https://github.com/rjindael","followers_url":"https://api.github.com/users/rjindael/followers","following_url":"https://api.github.com/users/rjindael/following{/other_user}","gists_url":"https://api.github.com/users/rjindael/gists{/gist_id}","starred_url":"https://api.github.com/users/rjindael/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjindael/subscriptions","organizations_url":"https://api.github.com/users/rjindael/orgs","repos_url":"https://api.github.com/users/rjindael/repos","events_url":"https://api.github.com/users/rjindael/events{/privacy}","received_events_url":"https://api.github.com/users/rjindael/received_events","type":"User","site_admin":false},"created_at":"2024-04-09T06:49:59Z","updated_at":"2024-04-09T06:49:59Z","author_association":"NONE","body":"This has done a great deal of damage to our development workflow. For now, I have come up with this solution for anyone running vcpkg on their machines that works for me:\r\n1. Download a copy of xz v5.4.4 (last known uncompromised version that is also used by vcpkg) - I got mine from the web archive. Link: https://web.archive.org/web/20240329183646if_/https://codeload.github.com/tukaani-project/xz/tar.gz/refs/tags/v5.4.4\r\n2. Place it in `<vcpkg_root>/downloads`, e.g. `c:/vcpkg/downloads`\r\n3. Empty out the `z_vcpkg_download_distfile_show_proxy_and_fail` function in `<vcpkg_root>/scripts/cmake/vcpkg_download_distfile.cmake` so that it does nothing. From what I know, this is mostly harmless since even if a download *does* fail it'll still error since it cannot find the file. It'll just happen later rather than sooner. This will also bypass the error caused by not being able to download xz. \r\n\r\nNot sure how to get past this for CI, but this serves as a temporary bandage solution ;) ","reactions":{"url":"https://api.github.com/repos/microsoft/vcpkg/issues/comments/2044264686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-04-09T06:50:00Z","org":{"id":6154722,"login":"microsoft","gravatar_id":"","url":"https://api.github.com/orgs/microsoft","avatar_url":"https://avatars.githubusercontent.com/u/6154722?"}}
