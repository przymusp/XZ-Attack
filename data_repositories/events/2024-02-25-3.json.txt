{"id":"35978949213","type":"IssueCommentEvent","actor":{"id":78042786,"login":"JiaT75","display_login":"JiaT75","gravatar_id":"","url":"https://api.github.com/users/JiaT75","avatar_url":"https://avatars.githubusercontent.com/u/78042786?"},"repo":{"id":553665726,"name":"tukaani-project/xz","url":"https://api.github.com/repos/tukaani-project/xz"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/85","repository_url":"https://api.github.com/repos/tukaani-project/xz","labels_url":"https://api.github.com/repos/tukaani-project/xz/issues/85/labels{/name}","comments_url":"https://api.github.com/repos/tukaani-project/xz/issues/85/comments","events_url":"https://api.github.com/repos/tukaani-project/xz/issues/85/events","html_url":"https://github.com/tukaani-project/xz/issues/85","id":2152403600,"node_id":"I_kwDOIQBEvs6ASxKQ","number":85,"title":"[Bug?]: Default option. Non determinism in multithreads?","user":{"login":"milkylainen","id":9418255,"node_id":"MDQ6VXNlcjk0MTgyNTU=","avatar_url":"https://avatars.githubusercontent.com/u/9418255?v=4","gravatar_id":"","url":"https://api.github.com/users/milkylainen","html_url":"https://github.com/milkylainen","followers_url":"https://api.github.com/users/milkylainen/followers","following_url":"https://api.github.com/users/milkylainen/following{/other_user}","gists_url":"https://api.github.com/users/milkylainen/gists{/gist_id}","starred_url":"https://api.github.com/users/milkylainen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milkylainen/subscriptions","organizations_url":"https://api.github.com/users/milkylainen/orgs","repos_url":"https://api.github.com/users/milkylainen/repos","events_url":"https://api.github.com/users/milkylainen/events{/privacy}","received_events_url":"https://api.github.com/users/milkylainen/received_events","type":"User","site_admin":false},"labels":[{"id":4687621022,"node_id":"LA_kwDOIQBEvs8AAAABF2drng","url":"https://api.github.com/repos/tukaani-project/xz/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2024-02-24T16:59:20Z","updated_at":"2024-02-25T03:27:59Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Well. Not really a bug, but perhaps more a question of default and helpful information.\r\nPlease correct me if I'm wrong here.\r\nI've always lived with the assumption that using xz with more than one thread isn't deterministic.\r\nIe, the compression result will vary with threads?\r\nBy changing the default, various usages will start to perhaps experience different results when building on different machines.\r\nLike packagers, embedded build envs etc.\r\n\r\nHas anything changed in the determinism department or can users just expect that default is to create variable results with the defaults?\r\n\r\n### Version\r\n\r\n5.6\r\n\r\n### Operating System\r\n\r\nLinux\r\n\r\n### Relevant log output\r\n\r\n_No response_","reactions":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/85/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tukaani-project/xz/issues/85/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/comments/1962800073","html_url":"https://github.com/tukaani-project/xz/issues/85#issuecomment-1962800073","issue_url":"https://api.github.com/repos/tukaani-project/xz/issues/85","id":1962800073,"node_id":"IC_kwDOIQBEvs50_fPJ","user":{"login":"JiaT75","id":78042786,"node_id":"MDQ6VXNlcjc4MDQyNzg2","avatar_url":"https://avatars.githubusercontent.com/u/78042786?v=4","gravatar_id":"","url":"https://api.github.com/users/JiaT75","html_url":"https://github.com/JiaT75","followers_url":"https://api.github.com/users/JiaT75/followers","following_url":"https://api.github.com/users/JiaT75/following{/other_user}","gists_url":"https://api.github.com/users/JiaT75/gists{/gist_id}","starred_url":"https://api.github.com/users/JiaT75/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JiaT75/subscriptions","organizations_url":"https://api.github.com/users/JiaT75/orgs","repos_url":"https://api.github.com/users/JiaT75/repos","events_url":"https://api.github.com/users/JiaT75/events{/privacy}","received_events_url":"https://api.github.com/users/JiaT75/received_events","type":"User","site_admin":false},"created_at":"2024-02-25T03:27:58Z","updated_at":"2024-02-25T03:27:58Z","author_association":"MEMBER","body":"Hello!\r\n\r\nI have seen this misconception before and I can understand where it is coming from. The short answer is that multi threaded compression mode is in fact deterministic.\r\n\r\nIt does not matter how many threads are used. @sam is correct, multi threaded encoding mode with 1 thread will produce the same as output as 10 threads. The output is *different* from single threaded mode, which is where the confusion happens. Single threaded mode does not put the block sizes in the headers and will put all of the data in a single block by default.\r\n\r\nSetting -T0 will always use multi threaded mode. In the past, if only one thread was used in -T0 mode then it would operate in single threaded mode and thus produce single threaded output. So I believe that is where the non-determinstic belief originated from, since sometimes the output would be different when using -T0. This is no longer the case.\r\n\r\nI hope this helps!","reactions":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/comments/1962800073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-02-25T03:28:00Z","org":{"id":116083088,"login":"tukaani-project","gravatar_id":"","url":"https://api.github.com/orgs/tukaani-project","avatar_url":"https://avatars.githubusercontent.com/u/116083088?"}}
