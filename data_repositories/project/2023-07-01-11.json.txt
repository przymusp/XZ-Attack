{"id":"30133790415","type":"IssueCommentEvent","actor":{"id":6077921,"login":"dearblue","display_login":"dearblue","gravatar_id":"","url":"https://api.github.com/users/dearblue","avatar_url":"https://avatars.githubusercontent.com/u/6077921?"},"repo":{"id":690914,"name":"postmodern/digest-crc","url":"https://api.github.com/repos/postmodern/digest-crc"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/postmodern/digest-crc/issues/37","repository_url":"https://api.github.com/repos/postmodern/digest-crc","labels_url":"https://api.github.com/repos/postmodern/digest-crc/issues/37/labels{/name}","comments_url":"https://api.github.com/repos/postmodern/digest-crc/issues/37/comments","events_url":"https://api.github.com/repos/postmodern/digest-crc/issues/37/events","html_url":"https://github.com/postmodern/digest-crc/issues/37","id":1627672609,"node_id":"I_kwDOAAqK4s5hBFAh","number":37,"title":"Would it make sense to have comparative benchmarks against other digests?","user":{"login":"yxhuvud","id":155895,"node_id":"MDQ6VXNlcjE1NTg5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/155895?v=4","gravatar_id":"","url":"https://api.github.com/users/yxhuvud","html_url":"https://github.com/yxhuvud","followers_url":"https://api.github.com/users/yxhuvud/followers","following_url":"https://api.github.com/users/yxhuvud/following{/other_user}","gists_url":"https://api.github.com/users/yxhuvud/gists{/gist_id}","starred_url":"https://api.github.com/users/yxhuvud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yxhuvud/subscriptions","organizations_url":"https://api.github.com/users/yxhuvud/orgs","repos_url":"https://api.github.com/users/yxhuvud/repos","events_url":"https://api.github.com/users/yxhuvud/events{/privacy}","received_events_url":"https://api.github.com/users/yxhuvud/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-03-16T14:49:51Z","updated_at":"2023-07-01T11:46:19Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Would it make sense to have benchmarks for one or a few of the ruby built in digests as well, so that there is some ballpark comparison number? ","reactions":{"url":"https://api.github.com/repos/postmodern/digest-crc/issues/37/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/postmodern/digest-crc/issues/37/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/postmodern/digest-crc/issues/comments/1615867392","html_url":"https://github.com/postmodern/digest-crc/issues/37#issuecomment-1615867392","issue_url":"https://api.github.com/repos/postmodern/digest-crc/issues/37","id":1615867392,"node_id":"IC_kwDOAAqK4s5gUC4A","user":{"login":"dearblue","id":6077921,"node_id":"MDQ6VXNlcjYwNzc5MjE=","avatar_url":"https://avatars.githubusercontent.com/u/6077921?v=4","gravatar_id":"","url":"https://api.github.com/users/dearblue","html_url":"https://github.com/dearblue","followers_url":"https://api.github.com/users/dearblue/followers","following_url":"https://api.github.com/users/dearblue/following{/other_user}","gists_url":"https://api.github.com/users/dearblue/gists{/gist_id}","starred_url":"https://api.github.com/users/dearblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dearblue/subscriptions","organizations_url":"https://api.github.com/users/dearblue/orgs","repos_url":"https://api.github.com/users/dearblue/repos","events_url":"https://api.github.com/users/dearblue/events{/privacy}","received_events_url":"https://api.github.com/users/dearblue/received_events","type":"User","site_admin":false},"created_at":"2023-07-01T11:46:19Z","updated_at":"2023-07-01T11:46:19Z","author_association":"CONTRIBUTOR","body":"The simple lookup table algorithm used in digest-crc is not very fast for modern general-purpose processors.\r\nFaster ones are in practical use.\r\n\r\nFor information:\r\n\r\n  - <https://create.stephan-brumme.com/crc32/>\r\n  - <https://github.com/htot/crc32c#benchmarks> (\"crc32c sarwate\" is equivalent to the algorithm used in digest-crc)\r\n\r\n---\r\n\r\n  - Previously zlib 1.2.11 and liblzma used \"Slicing by 4\" or \"Slicing by 8\" as announced by Intel in 2005.\r\n    <https://github.com/madler/zlib/blob/v1.2.11/crc32.c#L247>\r\n    <https://github.com/tukaani-project/xz/blob/v5.4.3/src/liblzma/check/crc32_fast.c>\r\n  - zlib 1.2.12 and later are currently parallelized by interleaving (outside of my understanding).\r\n    <https://github.com/madler/zlib/blob/v1.2.13/crc32.c#L748>\r\n    [The commit message mentions a 3x speedup from 1.5](https://github.com/madler/zlib/commit/f8719f5ae5acdc31d3794ddfea8ac963359de41e)ã€‚\r\n    Maybe <https://github.com/google/crc32c/blob/1.1.2/src/crc32c_portable.cc> is a fixed version of `crc32()` in zlib 1.2.12 by `N = 4, W = 4`.\r\n  - Some systems use the x86 CLMUL extension instruction, which allows even faster operations on the Galois field if available, and ARM has a similar extension instruction (outside my understanding).\r\n    <https://en.wikipedia.org/wiki/CLMUL_instruction_set>\r\n    <https://github.com/intel/soft-crc/blob/b98ee8a444b0da33a3ea09c6e9c8fee4f664821d/crc.h#L361> (archived repository)\r\n    <https://github.com/tukaani-project/xz/blob/v5.4.3/src/liblzma/check/crc64_fast.c#L139> (CRC-64 model)\r\n    <https://github.com/ebiggers/libdeflate/blob/v1.18/lib/x86/crc32_pclmul_template.h#L125>\r\n    <https://github.com/ebiggers/libdeflate/blob/v1.18/lib/arm/crc32_pmull_wide.h#L55>\r\n\r\nMy crc-turbo uses the \"Slicing by 16\" variant, but the zlib `crc32()` built into FreeBSD is about 1.6 times faster.\r\nAlso, `lzma_crc64()` by liblzma is about 3.6 times faster than my crc-turbo.\r\n\r\n:thinking: I may write an acceleration patch for digest-crc.\r\nHowever, I cannot handle CLMUL extension instructions, so it will be equivalent to \"Slicing by 16\" or \"Slicing by 8\".\r\n","reactions":{"url":"https://api.github.com/repos/postmodern/digest-crc/issues/comments/1615867392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-07-01T11:46:20Z"}
