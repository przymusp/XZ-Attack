{"id":"34857001601","type":"IssueCommentEvent","actor":{"id":17829319,"login":"ilya-fedin","display_login":"ilya-fedin","gravatar_id":"","url":"https://api.github.com/users/ilya-fedin","avatar_url":"https://avatars.githubusercontent.com/u/17829319?"},"repo":{"id":19374812,"name":"telegramdesktop/tdesktop","url":"https://api.github.com/repos/telegramdesktop/tdesktop"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/telegramdesktop/tdesktop/issues/27364","repository_url":"https://api.github.com/repos/telegramdesktop/tdesktop","labels_url":"https://api.github.com/repos/telegramdesktop/tdesktop/issues/27364/labels{/name}","comments_url":"https://api.github.com/repos/telegramdesktop/tdesktop/issues/27364/comments","events_url":"https://api.github.com/repos/telegramdesktop/tdesktop/issues/27364/events","html_url":"https://github.com/telegramdesktop/tdesktop/issues/27364","id":2083081911,"node_id":"I_kwDOASei3M58KU63","number":27364,"title":"building-linux.md  - fails due to docker brotli ERROR / January 2024","user":{"login":"maxbriliant","id":47421740,"node_id":"MDQ6VXNlcjQ3NDIxNzQw","avatar_url":"https://avatars.githubusercontent.com/u/47421740?v=4","gravatar_id":"","url":"https://api.github.com/users/maxbriliant","html_url":"https://github.com/maxbriliant","followers_url":"https://api.github.com/users/maxbriliant/followers","following_url":"https://api.github.com/users/maxbriliant/following{/other_user}","gists_url":"https://api.github.com/users/maxbriliant/gists{/gist_id}","starred_url":"https://api.github.com/users/maxbriliant/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxbriliant/subscriptions","organizations_url":"https://api.github.com/users/maxbriliant/orgs","repos_url":"https://api.github.com/users/maxbriliant/repos","events_url":"https://api.github.com/users/maxbriliant/events{/privacy}","received_events_url":"https://api.github.com/users/maxbriliant/received_events","type":"User","site_admin":false},"labels":[{"id":96671726,"node_id":"MDU6TGFiZWw5NjY3MTcyNg==","url":"https://api.github.com/repos/telegramdesktop/tdesktop/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-01-16T06:06:37Z","updated_at":"2024-01-16T10:27:09Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"### Steps to reproduce\n\nHopefully here is the solution for you guys\r\n\r\nhttps://github.com/google/brotli/issues/1087\n\n### Expected behaviour\n\nDocker Image should build a sufficient centos_env\n\n### Actual behaviour\n\nBuilding fails on 45/150 (brotli)\n\n### Operating system\n\nUbuntu 22.04\n\n### Version of Telegram Desktop\n\n4.14.4\n\n### Installation source\n\nOther (unofficial) source\n\n### Crash ID\n\n_No response_\n\n### Logs\n\n```shell\nsudo sh ./Telegram/build/prepare/linux.sh\r\nInstalling dependencies from lock file\r\n\r\nNo dependencies to install or update\r\n\r\nInstalling the current project: centos_env (0.1.0)\r\n[+] Building 54.6s (45/150)                                                         docker:default\r\n => [internal] load build definition from Dockerfile                                          0.0s\r\n => => transferring dockerfile: 31.61kB                                                       0.0s\r\n => [internal] load .dockerignore                                                             0.0s\r\n => => transferring context: 2B                                                               0.0s\r\n => resolve image config for docker.io/docker/dockerfile:1                                    0.7s\r\n => CACHED docker-image://docker.io/docker/dockerfile:1@sha256:ac85f380a63b13dfcefa89046420e  0.0s\r\n => [internal] load metadata for docker.io/library/rockylinux:8                               0.5s\r\n => [builder-base 1/5] FROM docker.io/library/rockylinux:8@sha256:c464612ef7e3d54d658c3eaa47  0.0s\r\n => CACHED [builder-base 2/5] RUN dnf -y install epel-release  && dnf config-manager --set-e  0.0s\r\n => CACHED [builder-base 3/5] WORKDIR /usr/src/Libraries                                      0.0s\r\n => CACHED [builder-base 4/5] RUN python3 -m pip install meson ninja                          0.0s\r\n => CACHED [builder-base 5/5] RUN mkdir /opt/cmake  && curl -sSLo cmake-3.27.6-Linux-x86_64.  0.0s\r\n => CACHED [xcb-proto 1/1] RUN git clone -b xcb-proto-1.16.0 --depth=1 https://github.com/gi  0.0s\r\n => CACHED [xcb 1/2] COPY --link --from=xcb-proto /usr/src/Libraries/xcb-proto-cache /        0.0s\r\n => CANCELED [mozjpeg 1/1] RUN git clone -b v4.1.4 --depth=1 https://github.com/mozilla/moz  53.2s\r\n => CACHED [patches 1/1] RUN git init patches  && cd patches  && git remote add origin https  0.0s\r\n => CANCELED [opus 1/1] RUN git clone -b v1.4 --depth=1 https://github.com/xiph/opus.git  &  52.5s\r\n => CANCELED [glib 1/1] RUN git clone -b 2.78.1 --depth=1 https://github.com/GNOME/glib.git  49.5s\r\n => CANCELED [xcb-util 1/1] RUN git clone -b xcb-util-0.4.1 --depth=1 --recursive https://g  51.2s\r\n => CANCELED [zlib 1/1] RUN git init zlib  && cd zlib  && git remote add origin https://git  50.4s\r\n => CANCELED [xcb 2/2] RUN git clone -b libxcb-1.16 --depth=1 https://github.com/gitlab-fre  51.0s\r\n => CANCELED [nasm 1/1] RUN git clone -b nasm-2.15.05 --depth=1 https://github.com/netwide-  53.1s\r\n => CANCELED [libwebp 1/1] RUN git clone -b chrome-m116-5845 --depth=1 https://github.com/w  52.1s\r\n => CACHED [nv-codec-headers 1/1] RUN git clone -b n12.0.16.0 --depth=1 https://github.com/F  0.0s\r\n => CANCELED [breakpad 1/1] RUN git clone -b v2023.01.27 --depth=1 https://chromium.googles  51.8s\r\n => CANCELED [openssl 1/1] RUN git clone -b OpenSSL_1_1_1-stable --depth=1 https://github.c  53.1s\r\n => CANCELED [pipewire 1/1] RUN git clone -b 0.3.25 --depth=1 https://github.com/PipeWire/p  52.5s\r\n => CANCELED [libproxy 1/1] RUN git clone -b 0.4.17 --depth=1 https://github.com/libproxy/l  51.3s\r\n => CANCELED [libxtst 1/1] RUN git clone -b libXtst-1.2.4 --depth=1 https://github.com/gitl  52.5s\r\n => CANCELED [libvpx 1/1] RUN git init libvpx  && cd libvpx  && git remote add origin https  52.4s\r\n => CANCELED [wayland 1/1] RUN git clone -b 1.19.0 --depth=1 https://github.com/gitlab-free  50.6s\r\n => CANCELED [libde265 1/1] RUN git clone -b v1.0.12 --depth=1 https://github.com/struktura  47.0s\r\n => CANCELED [xcb-render-util 1/1] RUN git clone -b xcb-util-renderutil-0.3.10 --depth=1 --  50.8s\r\n => CANCELED [libxcomposite 1/1] RUN git clone -b libXcomposite-0.4.6 --depth=1 https://git  48.7s\r\n => CANCELED [xcb-keysyms 1/1] RUN git clone -b xcb-util-keysyms-0.4.1 --depth=1 --recursiv  50.9s\r\n => CANCELED [libxdamage 1/1] RUN git clone -b libXdamage-1.1.6 --depth=1 https://github.co  48.2s\r\n => CANCELED [libxext 1/1] RUN git clone -b libXext-1.3.5 --depth=1 https://github.com/gitl  52.5s\r\n => CANCELED [libxrender 1/1] RUN git clone -b libXrender-0.9.11 --depth=1 https://github.c  48.0s\r\n => CANCELED [libxrandr 1/1] RUN git clone -b libXrandr-1.5.3 --depth=1 https://github.com/  47.8s\r\n => CANCELED [libxfixes 1/1] RUN git clone -b libXfixes-5.0.3 --depth=1 https://github.com/  47.5s\r\n => CANCELED [xcb-wm 1/1] RUN git clone -b xcb-util-wm-0.4.2 --depth=1 --recursive https://  51.3s\r\n => CANCELED [lcms2 1/1] RUN git clone -b lcms2.15 --depth=1 https://github.com/mm2/Little-  51.2s\r\n => CACHED [rnnoise 1/1] RUN git clone -b master --depth=1 https://github.com/desktop-app/rn  0.0s\r\n => CANCELED [highway 1/1] RUN git clone -b 1.0.7 --depth=1 https://github.com/google/highw  46.2s\r\n => CANCELED [xz 1/1] RUN git clone -b v5.4.4 --depth=1 https://github.com/tukaani-project/  46.1s\r\n => ERROR [brotli 1/1] RUN git clone -b v1.1.0 --depth=1 https://github.com/google/brotli.g  44.5s\r\n => CANCELED [protobuf 1/1] RUN git clone -b v21.9 --depth=1 --recursive https://github.com  46.8s\r\n------\r\n > [brotli 1/1] RUN git clone -b v1.1.0 --depth=1 https://github.com/google/brotli.git  && cd brotli       && cmake -GNinja -B build .             -DCMAKE_BUILD_TYPE=None                 -DBUILD_SHARED_LIBS=OFF            -DBROTLI_DISABLE_TESTS=ON       && cmake --build build --parallel       && DESTDIR=\"/usr/src/Libraries/brotli-cache\" cmake --install build         && cd ..        && rm -rf brotli:\r\n2.276 Cloning into 'brotli'...\r\n44.03 error: RPC failed; curl 18 transfer closed with outstanding read data remaining\r\n44.03 error: 3798 bytes of body are still expected\r\n44.03 fetch-pack: unexpected disconnect while reading sideband packet\r\n44.05 fatal: early EOF\r\n44.05 fatal: fetch-pack: invalid index-pack output\r\n------\r\nDockerfile:125\r\n--------------------\r\n 124 |     FROM builder AS brotli\r\n 125 | >>> RUN git clone -b v1.1.0 --depth=1 https://github.com/google/brotli.git \\\r\n 126 | >>>      && cd brotli \\\r\n 127 | >>>      && cmake -GNinja -B build . \\\r\n 128 | >>>              -DCMAKE_BUILD_TYPE=None \\\r\n 129 | >>>              -DBUILD_SHARED_LIBS=OFF \\\r\n 130 | >>>              -DBROTLI_DISABLE_TESTS=ON \\\r\n 131 | >>>      && cmake --build build --parallel \\\r\n 132 | >>>      && DESTDIR=\"/usr/src/Libraries/brotli-cache\" cmake --install build \\\r\n 133 | >>>      && cd .. \\\r\n 134 | >>>      && rm -rf brotli\r\n 135 |     \r\n--------------------\r\nERROR: failed to solve: process \"bash -c . /opt/rh/gcc-toolset-12/enable; exec bash -c \\\"$@\\\" -s git clone -b v1.1.0 --depth=1 https://github.com/google/brotli.git \\t&& cd brotli \\t&& cmake -GNinja -B build . \\t\\t-DCMAKE_BUILD_TYPE=None \\t\\t-DBUILD_SHARED_LIBS=OFF \\t\\t-DBROTLI_DISABLE_TESTS=ON \\t&& cmake --build build --parallel \\t&& DESTDIR=\\\"/usr/src/Libraries/brotli-cache\\\" cmake --install build \\t&& cd .. \\t&& rm -rf brotli\" did not complete successfully: exit code: 128\n```\n","reactions":{"url":"https://api.github.com/repos/telegramdesktop/tdesktop/issues/27364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/telegramdesktop/tdesktop/issues/27364/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/telegramdesktop/tdesktop/issues/comments/1893463025","html_url":"https://github.com/telegramdesktop/tdesktop/issues/27364#issuecomment-1893463025","issue_url":"https://api.github.com/repos/telegramdesktop/tdesktop/issues/27364","id":1893463025,"node_id":"IC_kwDOASei3M5w2_Px","user":{"login":"ilya-fedin","id":17829319,"node_id":"MDQ6VXNlcjE3ODI5MzE5","avatar_url":"https://avatars.githubusercontent.com/u/17829319?v=4","gravatar_id":"","url":"https://api.github.com/users/ilya-fedin","html_url":"https://github.com/ilya-fedin","followers_url":"https://api.github.com/users/ilya-fedin/followers","following_url":"https://api.github.com/users/ilya-fedin/following{/other_user}","gists_url":"https://api.github.com/users/ilya-fedin/gists{/gist_id}","starred_url":"https://api.github.com/users/ilya-fedin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilya-fedin/subscriptions","organizations_url":"https://api.github.com/users/ilya-fedin/orgs","repos_url":"https://api.github.com/users/ilya-fedin/repos","events_url":"https://api.github.com/users/ilya-fedin/events{/privacy}","received_events_url":"https://api.github.com/users/ilya-fedin/received_events","type":"User","site_admin":false},"created_at":"2024-01-16T10:27:07Z","updated_at":"2024-01-16T10:27:07Z","author_association":"CONTRIBUTOR","body":"The errors clearly tell you have a networking problem","reactions":{"url":"https://api.github.com/repos/telegramdesktop/tdesktop/issues/comments/1893463025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-01-16T10:27:09Z","org":{"id":6113871,"login":"telegramdesktop","gravatar_id":"","url":"https://api.github.com/orgs/telegramdesktop","avatar_url":"https://avatars.githubusercontent.com/u/6113871?"}}
