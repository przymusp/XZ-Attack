{"id":"38192469259","type":"IssueCommentEvent","actor":{"id":120408189,"login":"Larhzu","display_login":"Larhzu","gravatar_id":"","url":"https://api.github.com/users/Larhzu","avatar_url":"https://avatars.githubusercontent.com/u/120408189?"},"repo":{"id":553665726,"name":"tukaani-project/xz","url":"https://api.github.com/repos/tukaani-project/xz"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/90","repository_url":"https://api.github.com/repos/tukaani-project/xz","labels_url":"https://api.github.com/repos/tukaani-project/xz/issues/90/labels{/name}","comments_url":"https://api.github.com/repos/tukaani-project/xz/issues/90/comments","events_url":"https://api.github.com/repos/tukaani-project/xz/issues/90/events","html_url":"https://github.com/tukaani-project/xz/pull/90","id":2183813556,"node_id":"PR_kwDOIQBEvs5pft-s","number":90,"title":"Build: Let the users override the symbol versioning variant.","user":{"login":"skosukhin","id":19591868,"node_id":"MDQ6VXNlcjE5NTkxODY4","avatar_url":"https://avatars.githubusercontent.com/u/19591868?v=4","gravatar_id":"","url":"https://api.github.com/users/skosukhin","html_url":"https://github.com/skosukhin","followers_url":"https://api.github.com/users/skosukhin/followers","following_url":"https://api.github.com/users/skosukhin/following{/other_user}","gists_url":"https://api.github.com/users/skosukhin/gists{/gist_id}","starred_url":"https://api.github.com/users/skosukhin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skosukhin/subscriptions","organizations_url":"https://api.github.com/users/skosukhin/orgs","repos_url":"https://api.github.com/users/skosukhin/repos","events_url":"https://api.github.com/users/skosukhin/events{/privacy}","received_events_url":"https://api.github.com/users/skosukhin/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-03-13T11:53:44Z","updated_at":"2024-05-08T09:43:41Z","closed_at":"2024-03-20T19:04:53Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/tukaani-project/xz/pulls/90","html_url":"https://github.com/tukaani-project/xz/pull/90","diff_url":"https://github.com/tukaani-project/xz/pull/90.diff","patch_url":"https://github.com/tukaani-project/xz/pull/90.patch","merged_at":null},"body":"There are cases when the users want to decide themselves whether they want to have the generic (even on GNU/Linux) or the linux (even if we do not recommend that) symbol versioning variant. The former might be needed to circumvent compiler issues (i.e. the compiler does not support all features that are required for the linux versioning), the latter might help in overriding the assumptions made in the configure script.\r\n\r\n## Pull request checklist\r\n\r\nPlease check if your PR fulfills the following requirements:\r\n- [ ] Tests for the changes have been added (for bug fixes / features)\r\n- [ ] Docs have been reviewed and added / updated if needed (for bug fixes / features)\r\n- [x] Build was run locally and without warnings or errors\r\n- [x] All previous and new tests pass\r\n\r\n\r\n## Pull request type\r\n\r\nPlease check the type of change your PR introduces:\r\n- [ ] Bugfix\r\n- [ ] Feature\r\n- [ ] Code style update (formatting, renaming, typo fix)\r\n- [ ] Refactoring (no functional changes, no api changes)\r\n- [x] Build related changes\r\n- [ ] Documentation content changes\r\n- [ ] Other (please describe): \r\n\r\n\r\n## What is the current behavior?\r\nIt's not possible to override the symbol versioning variant on GNU/Linux:\r\n```console\r\n$ ./configure --enable-symbol-versions=auto | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... yes (linux)\r\n$ ./configure --enable-symbol-versions=yes | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... yes (linux)\r\n$ ./configure --enable-symbol-versions=no | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... no\r\n$ ./configure --enable-symbol-versions=linux | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... yes (linux)\r\n$ ./configure --enable-symbol-versions=generic | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... yes (linux)\r\n$ ./configure --enable-symbol-versions=something-else | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... yes (linux)\r\n$ ./configure --enable-symbol-versions --disable-shared | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... no (not building a shared library)\r\n$ ./configure --with-pic | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... \r\nconfigure: error: \r\n    On GNU/Linux, building both shared and static library at the same time\r\n    is not supported if --with-pic or --without-pic is used.\r\n    Use either --disable-shared or --disable-static to build one type\r\n    of library at a time. If both types are needed, build one at a time,\r\n    possibly picking only src/liblzma/.libs/liblzma.a from the static build.\r\n```\r\n\r\n## What is the new behavior?\r\nIt is possible to override the symbol versioning variant:\r\n```console\r\n$ ./configure --enable-symbol-versions=auto | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... yes (linux)\r\n$ ./configure --enable-symbol-versions=yes | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... yes (linux)\r\n$ ./configure --enable-symbol-versions=no | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... no\r\n$ ./configure --enable-symbol-versions=linux | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... yes (linux)\r\n$ ./configure --enable-symbol-versions=generic | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... yes (generic)\r\n$ ./configure --enable-symbol-versions=something-else | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... \r\nconfigure: error: unknown symbol versioning variant 'something-else'\r\n$ ./configure --enable-symbol-versions --disable-shared | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... no (not building a shared library)\r\n$ ./configure --with-pic | grep 'library symbol versioning'\r\nchecking if library symbol versioning should be used... \r\nconfigure: error: \r\n    On GNU/Linux, building both shared and static library at the same time\r\n    is not supported if --with-pic or --without-pic is used.\r\n    Use either --disable-shared or --disable-static to build one type\r\n    of library at a time. If both types are needed, build one at a time,\r\n    possibly picking only src/liblzma/.libs/liblzma.a from the static build.\r\n```\r\n\r\n## Does this introduce a breaking change?\r\n\r\n- [ ] Yes\r\n- [x] No\r\n\r\n## Other information\r\n\r\nIt looks like `--enable-symbol-versions=generic` was an unintended feature that existed before 0682439.","reactions":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/90/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tukaani-project/xz/issues/90/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/comments/2100185936","html_url":"https://github.com/tukaani-project/xz/pull/90#issuecomment-2100185936","issue_url":"https://api.github.com/repos/tukaani-project/xz/issues/90","id":2100185936,"node_id":"IC_kwDOIQBEvs59LktQ","user":{"login":"Larhzu","id":120408189,"node_id":"U_kgDOBy1IfQ","avatar_url":"https://avatars.githubusercontent.com/u/120408189?v=4","gravatar_id":"","url":"https://api.github.com/users/Larhzu","html_url":"https://github.com/Larhzu","followers_url":"https://api.github.com/users/Larhzu/followers","following_url":"https://api.github.com/users/Larhzu/following{/other_user}","gists_url":"https://api.github.com/users/Larhzu/gists{/gist_id}","starred_url":"https://api.github.com/users/Larhzu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Larhzu/subscriptions","organizations_url":"https://api.github.com/users/Larhzu/orgs","repos_url":"https://api.github.com/users/Larhzu/repos","events_url":"https://api.github.com/users/Larhzu/events{/privacy}","received_events_url":"https://api.github.com/users/Larhzu/received_events","type":"User","site_admin":false},"created_at":"2024-05-08T09:43:40Z","updated_at":"2024-05-08T09:43:40Z","author_association":"MEMBER","body":"@skosukhin: The PRs #90 and #91 were created when the master branch of XZ Utils was already under the 0BSD license. Due to the recent events, I plan to make one more release from the old v5.2 and v5.4 branches which are public domain, not 0BSD.\r\n\r\nIs it OK to you if I backport your two commits to the public domain releases? These are f56ed6fac6619b56b005878d3b5210e2f0d721c0 and 096bc0e3f8fb4bfc4d2f3f64a7f219401ffb4c31 in the master branch.\r\n\r\nI apologize that this is likely a silly question. I just want this kind of details to be extra clear.\r\n\r\nThanks!\r\n","reactions":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/comments/2100185936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-05-08T09:43:41Z","org":{"id":116083088,"login":"tukaani-project","gravatar_id":"","url":"https://api.github.com/orgs/tukaani-project","avatar_url":"https://avatars.githubusercontent.com/u/116083088?"}}
