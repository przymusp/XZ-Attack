{"id":"37135567152","type":"IssueCommentEvent","actor":{"id":106607441,"login":"correabuscar","display_login":"correabuscar","gravatar_id":"","url":"https://api.github.com/users/correabuscar","avatar_url":"https://avatars.githubusercontent.com/u/106607441?"},"repo":{"id":4542716,"name":"NixOS/nixpkgs","url":"https://api.github.com/repos/NixOS/nixpkgs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/NixOS/nixpkgs/issues/300055","repository_url":"https://api.github.com/repos/NixOS/nixpkgs","labels_url":"https://api.github.com/repos/NixOS/nixpkgs/issues/300055/labels{/name}","comments_url":"https://api.github.com/repos/NixOS/nixpkgs/issues/300055/comments","events_url":"https://api.github.com/repos/NixOS/nixpkgs/issues/300055/events","html_url":"https://github.com/NixOS/nixpkgs/issues/300055","id":2215862146,"node_id":"I_kwDOAEVQ_M6EE1-C","number":300055,"title":"xz-5.6.x is trojaned","user":{"login":"dfoxfranke","id":4708206,"node_id":"MDQ6VXNlcjQ3MDgyMDY=","avatar_url":"https://avatars.githubusercontent.com/u/4708206?v=4","gravatar_id":"","url":"https://api.github.com/users/dfoxfranke","html_url":"https://github.com/dfoxfranke","followers_url":"https://api.github.com/users/dfoxfranke/followers","following_url":"https://api.github.com/users/dfoxfranke/following{/other_user}","gists_url":"https://api.github.com/users/dfoxfranke/gists{/gist_id}","starred_url":"https://api.github.com/users/dfoxfranke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dfoxfranke/subscriptions","organizations_url":"https://api.github.com/users/dfoxfranke/orgs","repos_url":"https://api.github.com/users/dfoxfranke/repos","events_url":"https://api.github.com/users/dfoxfranke/events{/privacy}","received_events_url":"https://api.github.com/users/dfoxfranke/received_events","type":"User","site_admin":false},"labels":[{"id":6314750,"node_id":"MDU6TGFiZWw2MzE0NzUw","url":"https://api.github.com/repos/NixOS/nixpkgs/labels/0.kind:%20bug","name":"0.kind: bug","color":"84b6eb","default":false,"description":null},{"id":126506420,"node_id":"MDU6TGFiZWwxMjY1MDY0MjA=","url":"https://api.github.com/repos/NixOS/nixpkgs/labels/1.severity:%20security","name":"1.severity: security","color":"e11d21","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":44,"created_at":"2024-03-29T18:52:54Z","updated_at":"2024-04-03T17:05:09Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"See https://www.openwall.com/lists/oss-security/2024/03/29/4.\r\n\r\nThe trojaned source package is not in 23.11 but has been in unstable since https://github.com/NixOS/nixpkgs/commit/5c7c19cc7ef416b2f4a154263c6d04a50bbac86c. I'm trying to verify whether NixOS users are impacted by the exploit. I think we may be okay because NixOS doesn't have the openssh patch for systemd notification, and therefore openssh has no hook into liblzma.","reactions":{"url":"https://api.github.com/repos/NixOS/nixpkgs/issues/300055/reactions","total_count":116,"+1":115,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/NixOS/nixpkgs/issues/300055/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/NixOS/nixpkgs/issues/comments/2035131066","html_url":"https://github.com/NixOS/nixpkgs/issues/300055#issuecomment-2035131066","issue_url":"https://api.github.com/repos/NixOS/nixpkgs/issues/300055","id":2035131066,"node_id":"IC_kwDOAEVQ_M55TaK6","user":{"login":"correabuscar","id":106607441,"node_id":"U_kgDOBlqzUQ","avatar_url":"https://avatars.githubusercontent.com/u/106607441?v=4","gravatar_id":"","url":"https://api.github.com/users/correabuscar","html_url":"https://github.com/correabuscar","followers_url":"https://api.github.com/users/correabuscar/followers","following_url":"https://api.github.com/users/correabuscar/following{/other_user}","gists_url":"https://api.github.com/users/correabuscar/gists{/gist_id}","starred_url":"https://api.github.com/users/correabuscar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/correabuscar/subscriptions","organizations_url":"https://api.github.com/users/correabuscar/orgs","repos_url":"https://api.github.com/users/correabuscar/repos","events_url":"https://api.github.com/users/correabuscar/events{/privacy}","received_events_url":"https://api.github.com/users/correabuscar/received_events","type":"User","site_admin":false},"created_at":"2024-04-03T17:05:08Z","updated_at":"2024-04-03T17:05:08Z","author_association":"NONE","body":"<details>\r\n\r\n<summary> in reply \r\n\r\n[to above](https://github.com/NixOS/nixpkgs/issues/300055#issuecomment-2034546410) \r\n</summary>\r\n\r\n> > Another quick mitigation without mass rebuild is to pin Nixpkgs\r\n> \r\n> For people that want to update xz without doing mass-rebuild while still getting the very latest nixpkgs, I would expect something like this to work (not tested):\r\n> \r\n> ```\r\n>   system.replaceRuntimeDependencies = [({\r\n>     original = pkgs.xz;\r\n>     replacement = pkgs.xz.overrideAttrs (rec {\r\n>       # put any version you like\r\n>       version = \"5.4.6\";\r\n>       src = fetchgit {\r\n>         url = \"https://git.tukaani.org/xz.git\";\r\n>         rev = \"v${version}\";\r\n>         hash = \"sha256-uMUwR1I42R4hip5bJ1KOBKLZd9bb683z7xKeyB3M1Qg=\";\r\n>       };\r\n>     });\r\n>   })];\r\n> ```\r\n\r\n</details>\r\n\r\nI put the following in `/etc/nixos/configuration.nix`:\r\n```nix\r\n    #initially from: https://github.com/NixOS/nixpkgs/issues/300055#issuecomment-2034546410\r\n    system.replaceRuntimeDependencies = [({\r\n        original = pkgs.xz;\r\n        replacement = pkgs.xz.overrideAttrs (finalAttrs: prevAttrs: {\r\n        #(rec {\r\n            version = \"5.4.6\";\r\n            src = pkgs.fetchurl {\r\n            url = with finalAttrs;\r\n            # The original URL has been taken down.\r\n            # \"https://github.com/tukaani-project/xz/releases/download/v${version}/xz-${version}.tar.bz2\";\r\n            \"mirror://sourceforge/lzmautils/xz-5.4.6.tar.bz2\";\r\n            sha256 = \"sha256-kThRsnTo4dMXgeyUnxwj6NvPDs9uc6JDbcIXad0+b0k=\";\r\n            };\r\n\r\n#Can't use this due to no Makefile or something like that:                                                \r\n#            src = pkgs.fetchgit {\r\n#            url = \"https://git.tukaani.org/xz.git\";\r\n#            rev = \"v${finalAttrs.version}\";\r\n#            hash = \"sha256-uMUwR1I42R4hip5bJ1KOBKLZd9bb683z7xKeyB3M1Qg=\";\r\n#            };\r\n            });\r\n        })];\r\n```\r\n(note that I can use `${finalAttrs.version}` in the `url` instead, and/or can use `rec` instead of `finalAttrs: prevAttrs:`, it won't change anything, I just tried it with hardcoded `5.4.6` last time to be sure)\r\n\r\nIt did something for 3 minutes after `# nixos-rebuild switch` the first time I tried it, but how do I know it worked?\r\n\r\n<details>\r\n\r\n```\r\n$ nix-store --query --tree  /nix/var/nix/profiles/system |grep -- \"-xz-5\"\r\n│   └───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0\r\n│       └───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   ├───/nix/store/gc63f7dkfvmpd0cnalj3nwrk7i8xpbmq-xz-5.4.6-bin\r\n│   │   │   └───/nix/store/ablizbhgzblclxdqkh6d26b14s8dqnk0-xz-5.4.6\r\n│   │   │       └───/nix/store/ablizbhgzblclxdqkh6d26b14s8dqnk0-xz-5.4.6 [...]\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   │   └───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   │   │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   ├───/nix/store/gc63f7dkfvmpd0cnalj3nwrk7i8xpbmq-xz-5.4.6-bin [...]\r\n│   │       │   │   │   │   │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │       │   │   │   │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │       │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │       ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   │   │   │   │   │   │   │   │   ├───/nix/store/p6iz6wa3lqwzf5nbihpv52zpp1ji9243-xz-5.6.0-bin\r\n│   │   │   │   │   │   │   │   │   │   │   └───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   │   │   │   │   │   │   │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   │   │   │   │   │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   ├───/nix/store/5yv0177c7ip8h4591y71ac4cxaq3yx5q-xz-5.6.0-doc\r\n│   │   │   │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   ├───/nix/store/jx06mm16xjqaz90xndxa0f8r21p3bkj4-xz-5.6.0-man\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n│   │       │   ├───/nix/store/zg5z7q9gmwrfpkbzxlcq4gvbv2lwa7r2-xz-5.6.0\r\n│   │       │   │   └───/nix/store/zg5z7q9gmwrfpkbzxlcq4gvbv2lwa7r2-xz-5.6.0 [...]\r\n│   │       │   │   │   ├───/nix/store/zg5z7q9gmwrfpkbzxlcq4gvbv2lwa7r2-xz-5.6.0 [...]\r\n│   │       │   │   │   └───/nix/store/zg5z7q9gmwrfpkbzxlcq4gvbv2lwa7r2-xz-5.6.0 [...]\r\n│   │       │   │   │   ├───/nix/store/s17lg0fy74ncncp62f9lz7ikzxmkp59x-xz-5.6.0-bin\r\n│   │       │   │   │   │   └───/nix/store/zg5z7q9gmwrfpkbzxlcq4gvbv2lwa7r2-xz-5.6.0 [...]\r\n│   │       │   │   ├───/nix/store/zg5z7q9gmwrfpkbzxlcq4gvbv2lwa7r2-xz-5.6.0 [...]\r\n│   │       │   │   │   │   │   ├───/nix/store/zg5z7q9gmwrfpkbzxlcq4gvbv2lwa7r2-xz-5.6.0 [...]\r\n│   │       │   │   ├───/nix/store/zg5z7q9gmwrfpkbzxlcq4gvbv2lwa7r2-xz-5.6.0 [...]\r\n│   │       │   │   ├───/nix/store/zg5z7q9gmwrfpkbzxlcq4gvbv2lwa7r2-xz-5.6.0 [...]\r\n│   │   ├───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0 [...]\r\n\r\n```\r\n\r\n\r\n\r\n```\r\n[user@vbox1:~]$ nix why-depends /nix/var/nix/profiles/system /nix/store/ablizbhgzblclxdqkh6d26b14s8dqnk0-xz-5.4.6\r\n/nix/store/r0hag18xw29j50ad583rdlxnww1nznnv-nixos-system-vbox1-24.05.git.b1ee0bf6e321\r\n└───/nix/store/3gzm0idhr13acb9y478v61kfw9dn4izq-system-path\r\n    └───/nix/store/gc63f7dkfvmpd0cnalj3nwrk7i8xpbmq-xz-5.4.6-bin\r\n        └───/nix/store/ablizbhgzblclxdqkh6d26b14s8dqnk0-xz-5.4.6\r\n\r\n[user@vbox1:~]$ nix why-depends /nix/var/nix/profiles/system /nix/store/zg5z7q9gmwrfpkbzxlcq4gvbv2lwa7r2-xz-5.6.0\r\n/nix/store/r0hag18xw29j50ad583rdlxnww1nznnv-nixos-system-vbox1-24.05.git.b1ee0bf6e321\r\n└───/nix/store/378ggrc57vcc9sm8yq50sjcidpp3h9yz-etc\r\n    └───/nix/store/6rzqrphrav3x5fb5r2g6zvv5bgd3hpk2-etc-alsa-conf.d-49-pipewire-modules.conf\r\n        └───/nix/store/nh420baz2jmflgnwl5x72ncjqzqa398q-pipewire-1.0.3\r\n            └───/nix/store/0grf56m46f34q0fs5z0a7ramng46zbcy-ffmpeg-headless-6.1-lib\r\n                └───/nix/store/zg5z7q9gmwrfpkbzxlcq4gvbv2lwa7r2-xz-5.6.0\r\n\r\n[user@vbox1:~]$ nix why-depends /nix/var/nix/profiles/system /nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0\r\n/nix/store/r0hag18xw29j50ad583rdlxnww1nznnv-nixos-system-vbox1-24.05.git.b1ee0bf6e321\r\n└───/nix/store/9a25lb7iy59k40xzl44zj278d7dkfzmm-systemd-255.2\r\n    └───/nix/store/y2w59ka6i69rka3s5wc66awqh1bgaxjg-xz-5.6.0\r\n```\r\n\r\n</details>\r\n\r\nThanks.","reactions":{"url":"https://api.github.com/repos/NixOS/nixpkgs/issues/comments/2035131066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-04-03T17:05:09Z","org":{"id":487568,"login":"NixOS","gravatar_id":"","url":"https://api.github.com/orgs/NixOS","avatar_url":"https://avatars.githubusercontent.com/u/487568?"}}
{"id":"37135943513","type":"IssuesEvent","actor":{"id":36570018,"login":"ShinySilver","display_login":"ShinySilver","gravatar_id":"","url":"https://api.github.com/users/ShinySilver","avatar_url":"https://avatars.githubusercontent.com/u/36570018?"},"repo":{"id":490030893,"name":"GabeRundlett/gvox_engine","url":"https://api.github.com/repos/GabeRundlett/gvox_engine"},"payload":{"action":"opened","issue":{"url":"https://api.github.com/repos/GabeRundlett/gvox_engine/issues/13","repository_url":"https://api.github.com/repos/GabeRundlett/gvox_engine","labels_url":"https://api.github.com/repos/GabeRundlett/gvox_engine/issues/13/labels{/name}","comments_url":"https://api.github.com/repos/GabeRundlett/gvox_engine/issues/13/comments","events_url":"https://api.github.com/repos/GabeRundlett/gvox_engine/issues/13/events","html_url":"https://github.com/GabeRundlett/gvox_engine/issues/13","id":2223480608,"node_id":"I_kwDOHTVHLc6Eh58g","number":13,"title":"Broken build","user":{"login":"ShinySilver","id":36570018,"node_id":"MDQ6VXNlcjM2NTcwMDE4","avatar_url":"https://avatars.githubusercontent.com/u/36570018?v=4","gravatar_id":"","url":"https://api.github.com/users/ShinySilver","html_url":"https://github.com/ShinySilver","followers_url":"https://api.github.com/users/ShinySilver/followers","following_url":"https://api.github.com/users/ShinySilver/following{/other_user}","gists_url":"https://api.github.com/users/ShinySilver/gists{/gist_id}","starred_url":"https://api.github.com/users/ShinySilver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ShinySilver/subscriptions","organizations_url":"https://api.github.com/users/ShinySilver/orgs","repos_url":"https://api.github.com/users/ShinySilver/repos","events_url":"https://api.github.com/users/ShinySilver/events{/privacy}","received_events_url":"https://api.github.com/users/ShinySilver/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2024-04-03T17:16:38Z","updated_at":"2024-04-03T17:16:38Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hello,\r\nI had an error when trying to build the engine.\r\nFrom what I understand, the engine have a dependency called liblzma, as listed below:\r\n\r\n![image](https://github.com/GabeRundlett/gvox_engine/assets/36570018/083b43c4-a970-430b-8ee9-99113c041382)\r\n\r\nI had an error when building liblzma:\r\n\r\n![image](https://github.com/GabeRundlett/gvox_engine/assets/36570018/b966a91a-d29d-465c-9652-87376926e0ef)\r\n\r\nSo I dug a bit deeper, tried to download the file that vcpkg failed to download, and [discovered that xy repo was disabled](https://github.com/tukaani-project/xz/archive/v5.4.3.tar.gz).\r\n\r\nI used google, and found out that there was a backdoor in xy that was discovered yesterday. More details here: https://tukaani.org/xz-backdoor/\r\n\r\nSo for now, I guess the build is broken? And you might want to check if the version of liblzma you installed on your machine is affected ^^'\r\n\r\n","reactions":{"url":"https://api.github.com/repos/GabeRundlett/gvox_engine/issues/13/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/GabeRundlett/gvox_engine/issues/13/timeline","performed_via_github_app":null,"state_reason":null}},"public":true,"created_at":"2024-04-03T17:16:40Z"}
