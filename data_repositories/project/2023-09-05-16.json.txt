{"id":"31612791127","type":"PushEvent","actor":{"id":2251653,"login":"adrian-prantl","display_login":"adrian-prantl","gravatar_id":"","url":"https://api.github.com/users/adrian-prantl","avatar_url":"https://avatars.githubusercontent.com/u/2251653?"},"repo":{"id":216621244,"name":"adrian-prantl/llvm-project","url":"https://api.github.com/repos/adrian-prantl/llvm-project"},"payload":{"repository_id":216621244,"push_id":14929546120,"size":35,"distinct_size":35,"ref":"refs/heads/cherry-pick-20230725","head":"c219e2c55a1787d8d803474e705ccba7c3735c97","before":"79c9b05b2e54b3e54b694d5dbd42191e9678aea7","commits":[{"sha":"0a47d1e3163c15b372b6b34f505429a0c596770a","author":{"email":"adrian-prantl@users.noreply.github.com","name":"Adrian Prantl"},"message":"Merge pull request #7381 from adrian-prantl/cherry-pick-20230725\n\nCherry pick 20230725","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/0a47d1e3163c15b372b6b34f505429a0c596770a"},{"sha":"6a562bbd51c9ad1ff522d19a0b247595c1f85184","author":{"email":"hokein.wu@gmail.com","name":"Haojian Wu"},"message":"[Tooling/Inclusion] Add std::range symbols in the mapping.\n\nFixes https://github.com/llvm/llvm-project/issues/64191\n\nDifferential Revision: https://reviews.llvm.org/D156648\n\n(cherry picked from commit 171868dc2cd60c6e3eaeb3861b18ba0e22461291)","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/6a562bbd51c9ad1ff522d19a0b247595c1f85184"},{"sha":"e2c7d62cb570ba9adef2b38209746c33c752dca2","author":{"email":"am@git-apple-llvm","name":"git apple-llvm automerger"},"message":"Merge commit '6a562bbd51c9' from llvm.org/release/17.x into stable/20230725","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/e2c7d62cb570ba9adef2b38209746c33c752dca2"},{"sha":"466677b126855c79a05a1ebc111eea48053ad4ef","author":{"email":"martin@martin.st","name":"Martin Storsj√∂"},"message":"[llvm-windres] Implement the windres flag --use-temp-file\n\nWhether a temp file or a pipe is used for preprocessing is an\ninternal detail, this flag has a notable effect on the preprocessing\nin GNU windres. Without this flag, GNU windres passes command\narguments as-is to popen(), which means they get evaluated by a\nshell without being re-escaped for this case. To mimic this,\nllvm-windres has manually tried to unescape arguments.\n\nWhen GNU windres is given the --use-temp-file flag, it uses a\ndifferent API for invoking the preprocessor, and this API takes care\nof preserving special characters in the command line arguments.\nFor users of GNU windres, this means that by using --use-temp-file,\nthey don't need to do the (quite terrible) double escaping of\nquotes/spaces etc.\n\nThe xz project uses the --use-temp-file flag when invoking\nGNU windres, see\nhttps://github.com/tukaani-project/xz/commit/6b117d3b1fe91eb26d533ab16a2e552f84148d47.\nHowever as llvm-windres didn't implement this flag and just\nassumed the GNU windres popen() behaviour, they had to use a\ndifferent codepath for llvm-windres.\n\nThat separate codepath for llvm-windres broke later when llvm-windres\ngot slightly more accurate unescaping of lone quotes in\n0f4c6b120f21d582ab7c5c4f2b2a475086c34938 /\nhttps://reviews.llvm.org/D146848 (fixing a discrepancy to GNU\nwindres as found in https://github.com/llvm/llvm-project/issues/57334),\nand this was reported in\nhttps://github.com/mstorsjo/llvm-mingw/issues/363.\n\nNot touching the implementation of the --preprocessor option\nwith respect to the --use-temp-file flag; that option is doubly\ntricky as GNU windres changed its behaviour in a backwards incompatible\nway recently (and llvm-windres currently matches the old behaviour).\n(See\nhttps://sourceware.org/git/?p=binutils-gdb.git;a=commitdiff;h=21c33bcbe36377abf01614fb1b9be439a3b6de20,\nhttps://sourceware.org/bugzilla/show_bug.cgi?id=27594 and\nhttps://sourceware.org/git/?p=binutils-gdb.git;a=commitdiff;h=5edb8e3f5ad8d74a83fc0df7f6e4514eed0aa77f;hp=3abbafc2aacc6706fea3e3e326e2f08d107c3672\nfor the behaviour change.)\n\nDifferential Revision: https://reviews.llvm.org/D159223\n\n(cherry picked from commit 2bcc0fdc58a220cb9921b47ec8a32c85f2511a47)","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/466677b126855c79a05a1ebc111eea48053ad4ef"},{"sha":"eaf26adf613f7ae0060dc38a90feb2ab51dfaf85","author":{"email":"am@git-apple-llvm","name":"git apple-llvm automerger"},"message":"Merge commit '466677b12685' from llvm.org/release/17.x into stable/20230725","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/eaf26adf613f7ae0060dc38a90feb2ab51dfaf85"},{"sha":"ca372df48a05534d42130e6ecb4f6b275e003a08","author":{"email":"htsk30@gmail.com","name":"hstk30"},"message":"[AArch64] Fix arm neon vstx lane memVT size\n\nStN lane memory size set too big lead to alias analysis goes wrong.\n\nFixes https://github.com/llvm/llvm-project/issues/64696\n\nDifferential Revision: https://reviews.llvm.org/D158611\n\n(cherry picked from commit db8f6c009e5a17d304be7404e50eb20b2dd0c75b)","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/ca372df48a05534d42130e6ecb4f6b275e003a08"},{"sha":"06ecd1bd6383c7e54f9cbd1b393235b39d21ec8e","author":{"email":"am@git-apple-llvm","name":"git apple-llvm automerger"},"message":"Merge commit 'ca372df48a05' from llvm.org/release/17.x into stable/20230725","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/06ecd1bd6383c7e54f9cbd1b393235b39d21ec8e"},{"sha":"e04acab63c2682c690790111d688419158f15978","author":{"email":"i@maskray.me","name":"Fangrui Song"},"message":"[Driver] Report warnings for unclaimed TargetSpecific options for assembler input\n\nThis patch amends D151590 to not error for unlaimed TargetSpecific\noptions for `-x assembler` input files. This input type causes Driver to\nconstruct tools::ClangAs (-fintegrated-as) or other assemblers (e.g.\ntools::gnutools::Assembler) Their ConstructJobs methods, unlike\nClang::ConstructJobs, claim very few options. If an option is unclaimed,\nit either leads to a -Wunused-command-line-argument warning or an error\n(if `TargetSpecific` is set):\n```\n% clang '-###' --target=aarch64 -mbranch-protection=bti -c a.s\nclang: error: unsupported option '-mbranch-protection=' for target 'aarch64'\n```\n\nIt seems that downgrading the diagnostic to warning is most useful as\nmany users use CFLAGS even for `.s` files:\n```\nclang --target=aarch64 -mbranch-protection=bti -S a.c\nclang --target=aarch64 -mbranch-protection=bti -c a.s\n```\n\nI decide not to suppress the warning so that\n-Wunused-command-line-argument lovers still get a warning, and help\nprojects use proper ASFLAGS/CFLAGS/etc.\n\nNote: `-mbranch-protection=bti a.S` currently has no warning as `-x assembler-with-cpp`\ninstructs clangDriver to select tools::Clang and claim most options.\n\nRevert D159010 to demonstrate that we emit a warning for -mfpmath= for\n`-x assembler` input.\n\nModify my AIX cleanup cd18efb61d759405956dbd30e4b5f2720d8e1783 to\nadd an err_drv_unsupported_opt_for_target.\n\nReviewed By: thesamesam\n\nDifferential Revision: https://reviews.llvm.org/D159173\n\n(cherry picked from commit e9d454d1c195958645fb0948f8b97262e7f8b33a)","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/e04acab63c2682c690790111d688419158f15978"},{"sha":"ae3360b77a7e1a9558d39d3bcef2a7353e361cd1","author":{"email":"am@git-apple-llvm","name":"git apple-llvm automerger"},"message":"Merge commit 'e04acab63c26' from llvm.org/release/17.x into stable/20230725","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/ae3360b77a7e1a9558d39d3bcef2a7353e361cd1"},{"sha":"ecea6d6828d6591c80285ffb5c2be1312c201549","author":{"email":"v.g.vassilev@gmail.com","name":"Vassil Vassilev"},"message":"[CodeGen] First check the kind and then the llvm::Function properties.\n\nThis patch fixes valgrind reports from downstream consumers about conditional\njump over uninitialised memory.\n\nThe original report:\n\n```[ RUN      ] ScopeReflectionTest.IsComplete\n==987150== Conditional jump or move depends on uninitialised value(s)\n==987150==    at 0x1E1128F: clang::CodeGen::CodeGenModule::SetLLVMFunctionAttributesForDefinition(clang::Decl const*, llvm::Function*) (CodeGenModule.cpp:2391)\n==987150==    by 0x1E4F181: clang::CodeGen::CodeGenModule::EmitGlobalFunctionDefinition(clang::GlobalDecl, llvm::GlobalValue*) (CodeGenModule.cpp:5669)\n==987150==    by 0x1E4A194: clang::CodeGen::CodeGenModule::EmitGlobalDefinition(clang::GlobalDecl, llvm::GlobalValue*) (CodeGenModule.cpp:3909)\n==987150==    by 0x1E4A752: clang::CodeGen::CodeGenModule::EmitGlobal(clang::GlobalDecl) (CodeGenModule.cpp:3649)\n==987150==    by 0x1E532F5: clang::CodeGen::CodeGenModule::EmitTopLevelDecl(clang::Decl*) [clone .part.0] (CodeGenModule.cpp:6563)\n==987150==    by 0x1B0BEDD: (anonymous namespace)::CodeGeneratorImpl::HandleTopLevelDecl(clang::DeclGroupRef) (ModuleBuilder.cpp:190)\n==987150==    by 0x1AEA47B: clang::BackendConsumer::HandleTopLevelDecl(clang::DeclGroupRef) (CodeGenAction.cpp:235)\n==987150==    by 0x101B02F: clang::IncrementalASTConsumer::HandleTopLevelDecl(clang::DeclGroupRef) (IncrementalParser.cpp:52)\n==987150==    by 0x101ED93: clang::IncrementalParser::ParseOrWrapTopLevelDecl() (IncrementalParser.cpp:276)\n==987150==    by 0x101FBBC: clang::IncrementalParser::Parse(llvm::StringRef) (IncrementalParser.cpp:342)\n==987150==    by 0x100E104: clang::Interpreter::Parse(llvm::StringRef) (Interpreter.cpp:360)\n==987150==    by 0xE734C0: Cpp::Interpreter::Parse(llvm::StringRef) (CppInterOpInterpreter.h:172)\n==987150==  Uninitialised value was created by a heap allocation\n==987150==    at 0x844BE63: operator new(unsigned long) (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_memcheck-amd64-linux.so)\n==987150==    by 0x1B0C882: StartModule (ModuleBuilder.cpp:139)\n==987150==    by 0x1B0C882: clang::CodeGenerator::StartModule(llvm::StringRef, llvm::LLVMContext&) (ModuleBuilder.cpp:360)\n==987150==    by 0x101C4AF: clang::IncrementalParser::GenModule() (IncrementalParser.cpp:372)\n==987150==    by 0x101FC0E: clang::IncrementalParser::Parse(llvm::StringRef) (IncrementalParser.cpp:362)\n==987150==    by 0x100E104: clang::Interpreter::Parse(llvm::StringRef) (Interpreter.cpp:360)\n==987150==    by 0x100E243: clang::Interpreter::create(std::unique_ptr<clang::CompilerInstance, std::default_delete<clang::CompilerInstance> >) (Interpreter.cpp:279)\n==987150==    by 0xF2131A: compat::createClangInterpreter(std::vector<char const*, std::allocator<char const*> >&) (Compatibility.h:123)\n==987150==    by 0xF22AB9: Cpp::Interpreter::Interpreter(int, char const* const*, char const*, std::vector<std::shared_ptr<clang::ModuleFileExtension>, std::allocator<std::shared_ptr<clang::ModuleFileExtension> > > const&, void*, bool) (CppInterOpInterpreter.h:146)\n==987150==    by 0xF1827A: CreateInterpreter (CppInterOp.cpp:2494)\n==987150==    by 0xECFA0E: TestUtils::GetAllTopLevelDecls(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::vector<clang::Decl*, std::allocator<clang::Decl*> >&, bool) (Utils.cpp:23)\n==987150==    by 0xE9CB85: ScopeReflectionTest_IsComplete_Test::TestBody() (ScopeReflectionTest.cpp:71)\n==987150==    by 0xF0ED0C: void testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) (in /home/vvassilev/workspace/builds/scratch/cppyy/InterOp/build-with-clang-repl-release/unittests/CppInterOp/CppInterOpTests)\n==987150==\n```\n\nDifferential revision: https://reviews.llvm.org/D159339\n\n(cherry picked from commit 92246a9be0ba47788ada9621bef58ce7819be526)","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/ecea6d6828d6591c80285ffb5c2be1312c201549"},{"sha":"8a737d2ed957a02fdede5fe865823ef5e724462e","author":{"email":"am@git-apple-llvm","name":"git apple-llvm automerger"},"message":"Merge commit 'ecea6d6828d6' from llvm.org/release/17.x into stable/20230725","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/8a737d2ed957a02fdede5fe865823ef5e724462e"},{"sha":"a4a6f999b1fa7ef51f96ef9e8ec8887dc890b0b1","author":{"email":"e_zhdan@apple.com","name":"Egor Zhdan"},"message":"[APINotes] Support `SwiftImportAs` for C++ structs\n\nThis allows annotating C++ types as e.g. immortal references using API Notes.\n\nThis is based on the original patch by Zoe (411d3ab8).\n\nrdar://114933812","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/a4a6f999b1fa7ef51f96ef9e8ec8887dc890b0b1"},{"sha":"7150c6d4ee4090e6908ed65abd433f561c70877c","author":{"email":"i@maskray.me","name":"Fangrui Song"},"message":"[sanitizer] scanf interceptor: fix write size for %mc/%mC/%mS\n\nWhen the optional assignment-allocation character 'm' (Extension to the\nISO C standard) is present, we currently use internal_strlen(buf)+1 for\nall of cCsS[ (D85350). Fix cCS to use the correct size.\n\nFix https://github.com/llvm/llvm-project/issues/61768\n\nReviewed By: #sanitizers, vitalybuka\n\nDifferential Revision: https://reviews.llvm.org/D158485\n\n(cherry picked from commit beeb37a8f3275281be305d2d1afe35ca053e21c0)","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/7150c6d4ee4090e6908ed65abd433f561c70877c"},{"sha":"76802187bb0ede1a8b7a76a5538124d63aa866dd","author":{"email":"am@git-apple-llvm","name":"git apple-llvm automerger"},"message":"Merge commit '7150c6d4ee40' from llvm.org/release/17.x into stable/20230725","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/76802187bb0ede1a8b7a76a5538124d63aa866dd"},{"sha":"175a130b9f84583267ba04c3298cd73b02d5b76a","author":{"email":"elizabeth.andrews@intel.com","name":"Elizabeth Andrews"},"message":"[NFC][Clang] Fix static analyzer concern about null value dereference\n\nDifferential Revision: https://reviews.llvm.org/D157554","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/175a130b9f84583267ba04c3298cd73b02d5b76a"},{"sha":"22a3bfbe8ec634ba6c05b642f7b111ddbe20cd50","author":{"email":"am@git-apple-llvm","name":"git apple-llvm automerger"},"message":"Merge commit '175a130b9f84' from llvm.org/release/17.x into stable/20230725","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/22a3bfbe8ec634ba6c05b642f7b111ddbe20cd50"},{"sha":"c2c9c0f1388e435c4b2416d658ea005d5e724202","author":{"email":"zyn7109@gmail.com","name":"Younan Zhang"},"message":"[clang] Construct ExprRequirement with SubstitutionDiagnostic on SubstFailure\n\nWe're expecting a SubstitutionDiagnostic in diagnoseUnsatisfiedRequirement\nif the status of ExprRequirement is SubstFailure. Previously, the Requirement\nwas created with Expr on SubstFailure by mistake, which could lead to the\nassertion failure in the subsequent diagnosis.\n\nFixes https://github.com/clangd/clangd/issues/1726\nFixes https://github.com/llvm/llvm-project/issues/64723\nFixes https://github.com/llvm/llvm-project/issues/64172\n\nIn addition, this patch also fixes an invalid test from D129499.\n\nReviewed By: erichkeane\n\nDifferential Revision: https://reviews.llvm.org/D158061","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/c2c9c0f1388e435c4b2416d658ea005d5e724202"},{"sha":"7696caff5097ce5d8e262c401daf534981b83bd0","author":{"email":"am@git-apple-llvm","name":"git apple-llvm automerger"},"message":"Merge commit 'c2c9c0f1388e' from llvm.org/release/17.x into stable/20230725","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/7696caff5097ce5d8e262c401daf534981b83bd0"},{"sha":"5b4513afa40647eab89c5a55ab2d1c893229e873","author":{"email":"zyn7109@gmail.com","name":"Younan Zhang"},"message":"[clang][clangd] Ensure the stack bottom before building AST\n\n`clang::runWithSufficientStackSpace` requires the address of the\ninitial stack bottom to prevent potential stack overflows.\n\nIn addition, add a fallback to ASTFrontendAction in case any client\nforgets to call it when not through CompilerInstance::ExecuteAction,\nwhich is rare.\n\nFixes https://github.com/clangd/clangd/issues/1745.\n\nReviewed By: sammccall\n\nDifferential Revision: https://reviews.llvm.org/D158967\n\n(cherry picked from commit e257c0a9190637e44e292271103a13d70bec4b03)","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/5b4513afa40647eab89c5a55ab2d1c893229e873"},{"sha":"e84735807b123b899dae8b0ddda163b4a7bf3123","author":{"email":"am@git-apple-llvm","name":"git apple-llvm automerger"},"message":"Merge commit '5b4513afa406' from llvm.org/release/17.x into stable/20230725","distinct":true,"url":"https://api.github.com/repos/adrian-prantl/llvm-project/commits/e84735807b123b899dae8b0ddda163b4a7bf3123"}]},"public":true,"created_at":"2023-09-05T16:02:09Z"}
