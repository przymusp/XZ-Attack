{"id":"38943153398","type":"IssueCommentEvent","actor":{"id":120408189,"login":"Larhzu","display_login":"Larhzu","gravatar_id":"","url":"https://api.github.com/users/Larhzu","avatar_url":"https://avatars.githubusercontent.com/u/120408189?"},"repo":{"id":553665726,"name":"tukaani-project/xz","url":"https://api.github.com/repos/tukaani-project/xz"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/122","repository_url":"https://api.github.com/repos/tukaani-project/xz","labels_url":"https://api.github.com/repos/tukaani-project/xz/issues/122/labels{/name}","comments_url":"https://api.github.com/repos/tukaani-project/xz/issues/122/comments","events_url":"https://api.github.com/repos/tukaani-project/xz/issues/122/events","html_url":"https://github.com/tukaani-project/xz/issues/122","id":2326151776,"node_id":"I_kwDOIQBEvs6KpkJg","number":122,"title":"tsan also needs sanitizer nerf for crc64","user":{"login":"nate-thirdwave","id":96086763,"node_id":"U_kgDOBboq6w","avatar_url":"https://avatars.githubusercontent.com/u/96086763?v=4","gravatar_id":"","url":"https://api.github.com/users/nate-thirdwave","html_url":"https://github.com/nate-thirdwave","followers_url":"https://api.github.com/users/nate-thirdwave/followers","following_url":"https://api.github.com/users/nate-thirdwave/following{/other_user}","gists_url":"https://api.github.com/users/nate-thirdwave/gists{/gist_id}","starred_url":"https://api.github.com/users/nate-thirdwave/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nate-thirdwave/subscriptions","organizations_url":"https://api.github.com/users/nate-thirdwave/orgs","repos_url":"https://api.github.com/users/nate-thirdwave/repos","events_url":"https://api.github.com/users/nate-thirdwave/events{/privacy}","received_events_url":"https://api.github.com/users/nate-thirdwave/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2024-05-30T17:06:42Z","updated_at":"2024-06-03T12:03:33Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"The `no_sanitize_address` nerf for crc64 also needs `no_sanitize_thread` since the tsan checker also looks for heap-use-after-free.\r\n\r\n```\r\n--- src/liblzma/check/crc64_fast.c\t2023-11-01 12:19:29.000000000 +0000\r\n+++ src/liblzma/check/crc64_fast.c-new\t2024-05-30 16:56:41.935335535 +0000\r\n@@ -209,11 +209,14 @@\r\n // The intrinsics use 16-byte-aligned reads from buf, thus they may read\r\n // up to 15 bytes before or after the buffer (depending on the alignment\r\n // of the buf argument). The values of the extra bytes are ignored.\r\n-// This unavoidably trips -fsanitize=address so address sanitizier has\r\n-// to be disabled for this function.\r\n+// This unavoidably trips -fsanitize=address and -fsanitize=thread\r\n+// so the sanitizers have to be disabled for this function.\r\n #if lzma_has_attribute(__no_sanitize_address__)\r\n __attribute__((__no_sanitize_address__))\r\n #endif\r\n+#if lzma_has_attribute(__no_sanitize_thread__)\r\n+__attribute__((__no_sanitize_thread__))\r\n+#endif\r\n static uint64_t\r\n crc64_clmul(const uint8_t *buf, size_t size, uint64_t crc)\r\n {\r\n```","reactions":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/tukaani-project/xz/issues/122/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/comments/2145020260","html_url":"https://github.com/tukaani-project/xz/issues/122#issuecomment-2145020260","issue_url":"https://api.github.com/repos/tukaani-project/xz/issues/122","id":2145020260,"node_id":"IC_kwDOIQBEvs5_2mlk","user":{"login":"Larhzu","id":120408189,"node_id":"U_kgDOBy1IfQ","avatar_url":"https://avatars.githubusercontent.com/u/120408189?v=4","gravatar_id":"","url":"https://api.github.com/users/Larhzu","html_url":"https://github.com/Larhzu","followers_url":"https://api.github.com/users/Larhzu/followers","following_url":"https://api.github.com/users/Larhzu/following{/other_user}","gists_url":"https://api.github.com/users/Larhzu/gists{/gist_id}","starred_url":"https://api.github.com/users/Larhzu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Larhzu/subscriptions","organizations_url":"https://api.github.com/users/Larhzu/orgs","repos_url":"https://api.github.com/users/Larhzu/repos","events_url":"https://api.github.com/users/Larhzu/events{/privacy}","received_events_url":"https://api.github.com/users/Larhzu/received_events","type":"User","site_admin":false},"created_at":"2024-06-03T12:03:32Z","updated_at":"2024-06-03T12:03:32Z","author_association":"MEMBER","body":"Perhaps with Clang it could be ```__attribute__((__no_sanitize__(\"*\")))``` or such as clearly it can trip about every sanitizer. It's funny as [in assembly code](https://github.com/tukaani-project/xz/issues/112#issuecomment-2137131907) the code would be fine. But in any case the current code will be replaced with one that won't trip sanitizers and not require these attributes.","reactions":{"url":"https://api.github.com/repos/tukaani-project/xz/issues/comments/2145020260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-06-03T12:03:34Z","org":{"id":116083088,"login":"tukaani-project","gravatar_id":"","url":"https://api.github.com/orgs/tukaani-project","avatar_url":"https://avatars.githubusercontent.com/u/116083088?"}}
{"id":"38943552994","type":"CreateEvent","actor":{"id":120408189,"login":"Larhzu","display_login":"Larhzu","gravatar_id":"","url":"https://api.github.com/users/Larhzu","avatar_url":"https://avatars.githubusercontent.com/u/120408189?"},"repo":{"id":553665726,"name":"tukaani-project/xz","url":"https://api.github.com/repos/tukaani-project/xz"},"payload":{"ref":"solaris_debug","ref_type":"branch","master_branch":"master","description":"XZ Utils","pusher_type":"user"},"public":true,"created_at":"2024-06-03T12:15:02Z","org":{"id":116083088,"login":"tukaani-project","gravatar_id":"","url":"https://api.github.com/orgs/tukaani-project","avatar_url":"https://avatars.githubusercontent.com/u/116083088?"}}
{"id":"38944839281","type":"PushEvent","actor":{"id":120408189,"login":"Larhzu","display_login":"Larhzu","gravatar_id":"","url":"https://api.github.com/users/Larhzu","avatar_url":"https://avatars.githubusercontent.com/u/120408189?"},"repo":{"id":553665726,"name":"tukaani-project/xz","url":"https://api.github.com/repos/tukaani-project/xz"},"payload":{"repository_id":553665726,"push_id":18705529398,"size":1,"distinct_size":1,"ref":"refs/heads/solaris_debug","head":"7b183d31cd3eab5cc3a287b3db5d66288248f22b","before":"6a53d99465a345f9eec74ef33cacdd8bf3aa1f2e","commits":[{"sha":"7b183d31cd3eab5cc3a287b3db5d66288248f22b","author":{"email":"lasse.collin@tukaani.org","name":"Lasse Collin"},"message":"CI: Solaris debug 2\n\ntr doesn't support '\\n' but it's fine on Solaris with these changes.\nNow also sed won't get input that lacks a newline at the end.","distinct":true,"url":"https://api.github.com/repos/tukaani-project/xz/commits/7b183d31cd3eab5cc3a287b3db5d66288248f22b"}]},"public":true,"created_at":"2024-06-03T12:49:56Z","org":{"id":116083088,"login":"tukaani-project","gravatar_id":"","url":"https://api.github.com/orgs/tukaani-project","avatar_url":"https://avatars.githubusercontent.com/u/116083088?"}}
