{"id":"39020861771","type":"IssueCommentEvent","actor":{"id":120408189,"login":"Larhzu","display_login":"Larhzu","gravatar_id":"","url":"https://api.github.com/users/Larhzu","avatar_url":"https://avatars.githubusercontent.com/u/120408189?"},"repo":{"id":68312233,"name":"microsoft/vcpkg","url":"https://api.github.com/repos/microsoft/vcpkg"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/microsoft/vcpkg/issues/39024","repository_url":"https://api.github.com/repos/microsoft/vcpkg","labels_url":"https://api.github.com/repos/microsoft/vcpkg/issues/39024/labels{/name}","comments_url":"https://api.github.com/repos/microsoft/vcpkg/issues/39024/comments","events_url":"https://api.github.com/repos/microsoft/vcpkg/issues/39024/events","html_url":"https://github.com/microsoft/vcpkg/pull/39024","id":2324377821,"node_id":"PR_kwDOBBJcqc5w8TYH","number":39024,"title":"[liblzma] Update to version 5.6.2.","user":{"login":"teo-tsirpanis","id":12659251,"node_id":"MDQ6VXNlcjEyNjU5MjUx","avatar_url":"https://avatars.githubusercontent.com/u/12659251?v=4","gravatar_id":"","url":"https://api.github.com/users/teo-tsirpanis","html_url":"https://github.com/teo-tsirpanis","followers_url":"https://api.github.com/users/teo-tsirpanis/followers","following_url":"https://api.github.com/users/teo-tsirpanis/following{/other_user}","gists_url":"https://api.github.com/users/teo-tsirpanis/gists{/gist_id}","starred_url":"https://api.github.com/users/teo-tsirpanis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/teo-tsirpanis/subscriptions","organizations_url":"https://api.github.com/users/teo-tsirpanis/orgs","repos_url":"https://api.github.com/users/teo-tsirpanis/repos","events_url":"https://api.github.com/users/teo-tsirpanis/events{/privacy}","received_events_url":"https://api.github.com/users/teo-tsirpanis/received_events","type":"User","site_admin":false},"labels":[{"id":1320931868,"node_id":"MDU6TGFiZWwxMzIwOTMxODY4","url":"https://api.github.com/repos/microsoft/vcpkg/labels/category:port-update","name":"category:port-update","color":"40c75f","default":false,"description":"The issue is with a library, which is requesting update new revision"},{"id":1711056306,"node_id":"MDU6TGFiZWwxNzExMDU2MzA2","url":"https://api.github.com/repos/microsoft/vcpkg/labels/info:reviewed","name":"info:reviewed","color":"6cf079","default":false,"description":"Pull Request changes follow basic guidelines"},{"id":3066883587,"node_id":"MDU6TGFiZWwzMDY2ODgzNTg3","url":"https://api.github.com/repos/microsoft/vcpkg/labels/requires:vcpkg-team-review","name":"requires:vcpkg-team-review","color":"5319e7","default":false,"description":"This PR or issue requires someone on the vcpkg team to take a further look."}],"state":"open","locked":false,"assignee":{"login":"LilyWangLL","id":94091114,"node_id":"U_kgDOBZu3ag","avatar_url":"https://avatars.githubusercontent.com/u/94091114?v=4","gravatar_id":"","url":"https://api.github.com/users/LilyWangLL","html_url":"https://github.com/LilyWangLL","followers_url":"https://api.github.com/users/LilyWangLL/followers","following_url":"https://api.github.com/users/LilyWangLL/following{/other_user}","gists_url":"https://api.github.com/users/LilyWangLL/gists{/gist_id}","starred_url":"https://api.github.com/users/LilyWangLL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LilyWangLL/subscriptions","organizations_url":"https://api.github.com/users/LilyWangLL/orgs","repos_url":"https://api.github.com/users/LilyWangLL/repos","events_url":"https://api.github.com/users/LilyWangLL/events{/privacy}","received_events_url":"https://api.github.com/users/LilyWangLL/received_events","type":"User","site_admin":false},"assignees":[{"login":"LilyWangLL","id":94091114,"node_id":"U_kgDOBZu3ag","avatar_url":"https://avatars.githubusercontent.com/u/94091114?v=4","gravatar_id":"","url":"https://api.github.com/users/LilyWangLL","html_url":"https://github.com/LilyWangLL","followers_url":"https://api.github.com/users/LilyWangLL/followers","following_url":"https://api.github.com/users/LilyWangLL/following{/other_user}","gists_url":"https://api.github.com/users/LilyWangLL/gists{/gist_id}","starred_url":"https://api.github.com/users/LilyWangLL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LilyWangLL/subscriptions","organizations_url":"https://api.github.com/users/LilyWangLL/orgs","repos_url":"https://api.github.com/users/LilyWangLL/repos","events_url":"https://api.github.com/users/LilyWangLL/events{/privacy}","received_events_url":"https://api.github.com/users/LilyWangLL/received_events","type":"User","site_admin":false}],"milestone":null,"comments":8,"created_at":"2024-05-29T23:10:42Z","updated_at":"2024-06-05T12:14:48Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/microsoft/vcpkg/pulls/39024","html_url":"https://github.com/microsoft/vcpkg/pull/39024","diff_url":"https://github.com/microsoft/vcpkg/pull/39024.diff","patch_url":"https://github.com/microsoft/vcpkg/pull/39024.patch","merged_at":null},"body":"- [X] Changes comply with the [maintainer guide](https://github.com/microsoft/vcpkg-docs/blob/main/vcpkg/contributing/maintainer-guide.md).\n- [X] SHA512s are updated for each updated download.\n- [X] The \"supports\" clause reflects platforms that may be fixed by this new version.\n- [ ] Any fixed [CI baseline](https://github.com/microsoft/vcpkg/blob/master/scripts/ci.baseline.txt) entries are removed from that file.\n- [ ] Any patches that are no longer applied are deleted from the port's directory.\n- [X] The version database is fixed by rerunning `./vcpkg x-add-version --all` and committing the result.\n- [X] Only one version is added to each modified port's versions file.\n\nThis PR updates liblzma to the just-released version 5.6.2. I first copied the reverted port for 5.6.0, and updated versions.\n\nI also enabled the tools feature on Windows; the tools seem to run fine there.","reactions":{"url":"https://api.github.com/repos/microsoft/vcpkg/issues/39024/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/microsoft/vcpkg/issues/39024/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/microsoft/vcpkg/issues/comments/2149685510","html_url":"https://github.com/microsoft/vcpkg/pull/39024#issuecomment-2149685510","issue_url":"https://api.github.com/repos/microsoft/vcpkg/issues/39024","id":2149685510,"node_id":"IC_kwDOBBJcqc6AIZkG","user":{"login":"Larhzu","id":120408189,"node_id":"U_kgDOBy1IfQ","avatar_url":"https://avatars.githubusercontent.com/u/120408189?v=4","gravatar_id":"","url":"https://api.github.com/users/Larhzu","html_url":"https://github.com/Larhzu","followers_url":"https://api.github.com/users/Larhzu/followers","following_url":"https://api.github.com/users/Larhzu/following{/other_user}","gists_url":"https://api.github.com/users/Larhzu/gists{/gist_id}","starred_url":"https://api.github.com/users/Larhzu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Larhzu/subscriptions","organizations_url":"https://api.github.com/users/Larhzu/orgs","repos_url":"https://api.github.com/users/Larhzu/repos","events_url":"https://api.github.com/users/Larhzu/events{/privacy}","received_events_url":"https://api.github.com/users/Larhzu/received_events","type":"User","site_admin":false},"created_at":"2024-06-05T12:14:47Z","updated_at":"2024-06-05T12:14:47Z","author_association":"NONE","body":"I understand a few details better and made a few commits upstream. Here are updates to my earlier five questions and also two new ones:\r\n\r\n1. I now think that `add_support_ios.patch` never made any sense other than forcing the build to succeed for users that only wanted liblzma. From [Apple's docs](https://developer.apple.com/library/archive/documentation/CoreFoundation/Conceptual/CFBundles/AboutBundles/AboutBundles.html): \"_Static libraries, dynamic libraries, shell scripts, and UNIX command line tools do not use the bundle structure._\" Thus, [the commit from 2020](https://github.com/tukaani-project/xz/commit/21588ca34af98738954fc12ded1b89d7294ef646) is correct. The bug reporter had confirmed to me via email that the commit fixed the build on iOS. So `add_support_ios.patch` should be removed as it nowadays does nothing.\r\n\r\n2. `fix_config_include.patch` clearly can be removed.\r\n\r\n3. The equivalent of `win_output_name.patch` (without `IMPORT_PREFIX \"\"`) is now in [upstream repository](https://github.com/tukaani-project/xz/commit/e0d6d05ce0d464e966c0669bbf869202a43cc2f7). It fixed naming bugs on Cygwin and MSYS2 too, that is, my old method was fundamentally wrong. Note that `win_output_name.patch` in this PR is currently buggy because it has `IMPORT_PREFIX \"\"` (it must have been a merge conflict when the patch was updated but it still wasn't noticed).\r\n\r\n4. My `Threads::Threads` question likely needs no changes anywhere.\r\n\r\n5. `liblzma.pc` is now installed [even when building with MSVC](https://github.com/tukaani-project/xz/commit/afa938e429c1ce07d26d02999352fb014b62ff3d). The generated `liblzma.pc` now [uses paths that are relative](https://github.com/tukaani-project/xz/commit/5d1c649ba9eb7a5b9371252ebfbc2911dc774e69) to `${prefix}`. I have no idea if it helps in `portfile.cmake` though, that is, if it was now possible to rely on upstream `CMakeLists.txt` to install `liblzma.pc` correctly.\r\n\r\n6. Since XZ Utils 5.6.0, `CMakeLists.txt` installs `xzgrep` and other POSIX shell scripts `if(UNIX)`. These scripts rely on the `xz` tool. I suppose `build-tools.patch` should cover the scripts too as installing the scripts without the `xz` tool makes no sense.\r\n\r\n7. Excluding the POSIX shell scripts, the command line tools can be built on Windows even with MSVC. This is a new feature since 5.6.0. `vcpkg.json` still has `\"supports\": \"!windows, mingw\"`. I wonder if that was forgotten to be changed (perhaps the info in the NEWS file wasn't noticed) or if it is intentional because the MSVC build of the command line tools link in GNU getopt_long which is under the GNU LGPLv2.1 (not needed with MinGW-w64).\r\n\r\nI would be nice to know if the upstream changes are OK from vcpkg's point of view. The changes will be in the next stable release if there are no complaints. Thanks!\r\n\r\nThe Autotools-based build has options to disable individual command line tools but the CMake-based build doesn't. Perhaps such options should be added upstream so that `build-tools.patch` wouldn't be needed here (and perhaps elsewhere) but I didn't do it now. It is possible to build only liblzma by building and installing only the specific CMake components but I understand that it might not be so convenient.\r\n","reactions":{"url":"https://api.github.com/repos/microsoft/vcpkg/issues/comments/2149685510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-06-05T12:14:48Z","org":{"id":6154722,"login":"microsoft","gravatar_id":"","url":"https://api.github.com/orgs/microsoft","avatar_url":"https://avatars.githubusercontent.com/u/6154722?"}}
