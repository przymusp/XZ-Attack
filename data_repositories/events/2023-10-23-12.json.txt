{"id":"32770406239","type":"CreateEvent","actor":{"id":120408189,"login":"Larhzu","display_login":"Larhzu","gravatar_id":"","url":"https://api.github.com/users/Larhzu","avatar_url":"https://avatars.githubusercontent.com/u/120408189?"},"repo":{"id":553665726,"name":"tukaani-project/xz","url":"https://api.github.com/repos/tukaani-project/xz"},"payload":{"ref":"crc_edits","ref_type":"branch","master_branch":"master","description":"XZ Utils Official Repository","pusher_type":"user"},"public":true,"created_at":"2023-10-23T12:20:29Z","org":{"id":116083088,"login":"tukaani-project","gravatar_id":"","url":"https://api.github.com/orgs/tukaani-project","avatar_url":"https://avatars.githubusercontent.com/u/116083088?"}}
{"id":"32771115520","type":"PushEvent","actor":{"id":120408189,"login":"Larhzu","display_login":"Larhzu","gravatar_id":"","url":"https://api.github.com/users/Larhzu","avatar_url":"https://avatars.githubusercontent.com/u/120408189?"},"repo":{"id":553665726,"name":"tukaani-project/xz","url":"https://api.github.com/repos/tukaani-project/xz"},"payload":{"repository_id":553665726,"push_id":15528297818,"size":2,"distinct_size":2,"ref":"refs/heads/visibility_hidden","head":"5e57fe2f0acef3cbcd3160e5e9b43a267ec829fb","before":"980d07c1522bf0f818a53d2ede13f08d8d7831c3","commits":[{"sha":"4e7cf460757c68181c473e93e5d319361a9b55b1","author":{"email":"lasse.collin@tukaani.org","name":"Lasse Collin"},"message":"liblzma: #define lzma_attr_visibility_hidden in common.h.\n\nIn ELF shared libs:\n\n-fvisibility=hidden affects definitions of symbols but not\ndeclarations.[*] This doesn't affect direct calls to functions\ninside liblzma as a linker can replace a call to lzma_foo@plt\nwith a call directly to lzma_foo when -fvisibility=hidden is used.\n\n[*] It has to be like this because otherwise every installed\n    header file would need to explictly set the symbol visibility\n    to default.\n\nWhen accessing extern variables that aren't defined in the\nsame translation unit, compiler assumes that the variable has\nthe default visibility and thus indirection is needed. Unlike\nfunction calls, linker cannot optimize this.\n\nUsing __attribute__((__visibility__(\"hidden\"))) with the extern\nvariable declarations tells the compiler that indirection isn't\nneeded because the definition is in the same shared library.\n\nAbout 15+ years ago, someone told me that it would be good if\nthe CRC tables would be defined in the same translation unit\nas the C code of the CRC functions. While I understood that it\ncould help a tiny amount, I didn't want to change the code because\na separate translation unit for the CRC tables was needed for the\nx86 assembly code anyway. But when visibility attributes are\nsupported, simply marking the extern declaration with the\nhidden attribute will get identical result. When there are only\na few affected variables, this is trivial to do. I wish I had\nunderstood this back then already.","distinct":true,"url":"https://api.github.com/repos/tukaani-project/xz/commits/4e7cf460757c68181c473e93e5d319361a9b55b1"},{"sha":"5e57fe2f0acef3cbcd3160e5e9b43a267ec829fb","author":{"email":"lasse.collin@tukaani.org","name":"Lasse Collin"},"message":"liblzma: Use lzma_attr_visibility_hidden on private extern declarations.\n\nThese variables are internal to liblzma and not exposed in the API.","distinct":true,"url":"https://api.github.com/repos/tukaani-project/xz/commits/5e57fe2f0acef3cbcd3160e5e9b43a267ec829fb"}]},"public":true,"created_at":"2023-10-23T12:44:34Z","org":{"id":116083088,"login":"tukaani-project","gravatar_id":"","url":"https://api.github.com/orgs/tukaani-project","avatar_url":"https://avatars.githubusercontent.com/u/116083088?"}}
